<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>111c8b7476bd4526a8dba0c4ceb8d6aa</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section
id="customer-purchase-behavior-analysis-using-descriptive-statistics"
class="cell markdown" id="XVRRli7RVQFs">
<h1>Customer Purchase Behavior Analysis using Descriptive
Statistics</h1>
<ul>
<li>Rijwan Shaikh</li>
</ul>
</section>
<div class="cell markdown" id="jfhbp8ZDB7If">
<p>##Problem Statement</p>
</div>
<div class="cell markdown" id="EB1yLJOSV1gx">
<p>üîç <strong>Problem Statement</strong>:</p>
<p>Welcome to the Probability and Statistics project! üìäüîç In this
exciting journey, you'll get the chance to apply the concepts you've
learned in probability theory and statistics to analyze a real-world
dataset. This project is your opportunity to dive deep into the world of
data analysis and gain practical experience with the tools and
techniques you've been learning. üöÄ</p>
<p>üéØ <strong>Objective</strong>:</p>
<p>Your mission is to analyze the provided dataset containing customer
information and purchasing behavior to make informed decisions. Your
goal is to identify patterns, trends, and correlations that will help
your company optimize its marketing efforts and increase offer
acceptance rates. üéâ</p>
</div>
<div class="cell markdown" id="C6I6fCk2B4W-">
<p>##About the Dataset</p>
</div>
<div class="cell markdown" id="E_yV1UBOAu7Z">
<p>Here's the link to the <a
href="https://docs.google.com/spreadsheets/d/12ln9iTNcVNOMYi_AU-OczKpa_KIP8XyVbsjk81Na8Yk/edit?usp=sharing">dataset</a></p>
<p>This data was gathered during last year's campaign. Data description
is as follows;</p>
<ol>
<li>Response (target) - 1 if customer accepted the offer in the last
campaign, 0 otherwise</li>
<li>ID - Unique ID of each customer</li>
<li>Year_Birth - Age of the customer</li>
<li>Complain - 1 if the customer complained in the last 2 years</li>
<li>Dt_Customer - date of customer's enrollment with the company</li>
<li>Education - customer's level of education</li>
<li>Marital - customer's marital status</li>
<li>Kidhome - number of small children in customer's household</li>
<li>Teenhome - number of teenagers in customer's household</li>
<li>Income - customer's yearly household income</li>
<li>MntFishProducts - the amount spent on fish products in the last 2
years</li>
<li>MntMeatProducts - the amount spent on meat products in the last 2
years</li>
<li>MntFruits - the amount spent on fruits products in the last 2
years</li>
<li>MntSweetProducts - amount spent on sweet products in the last 2
years</li>
<li>MntWines - the amount spent on wine products in the last 2
years</li>
<li>MntGoldProds - the amount spent on gold products in the last 2
years</li>
<li>NumDealsPurchases - number of purchases made with discount</li>
<li>NumCatalogPurchases - number of purchases made using catalog (buying
goods to be shipped through the mail)</li>
<li>NumStorePurchases - number of purchases made directly in stores</li>
<li>NumWebPurchases - number of purchases made through the company's
website</li>
<li>NumWebVisitsMonth - number of visits to company's website in the
last month</li>
<li>Recency - number of days since the last purchase</li>
</ol>
</div>
<div class="cell markdown" id="VX0CacB9qEJp">
<p>##Task 1 - Basic CleanUp</p>
<ul>
<li><p><strong>Clean and preprocess the dataset (handling missing
values, data types, etc.).</strong></p></li>
<li><p><strong>Analyze the distribution of customer demographics (age,
education, marital status) using descriptive statistics and
visualizations.</strong></p></li>
</ul>
</div>
<div class="cell markdown" id="93wL1OjRqKAp">
<p><strong>Deliverables</strong>:</p>
<ul>
<li><p><strong>Cleaned and Preprocessed Dataset</strong>:</p>
<p>Provide a detailed report on the steps taken to handle missing
values, including imputation methods used if applicable. Document the
process of ensuring consistent data types for each variable, addressing
any inconsistencies.</p></li>
<li><p><strong>Summary of Basic Statistics</strong>:</p>
<p>Present calculated statistics such as mean, median, variance, and
standard deviation for each relevant numerical variable. Include a
concise table or summary showcasing these measures for easy
reference.</p></li>
</ul>
</div>
<div class="cell markdown" id="WvBZsMXuJAGL">
<p>#Load Dataset</p>
</div>
<div class="cell markdown" id="l8x7DeniJI7B">
<p>###Required Libraries</p>
</div>
<div class="cell code" data-execution_count="3" id="ZWI5hPsZJQeh">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># üì¶ Core Libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># üìä Visualization</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For Jupyter Notebooks to display plots inline</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># üìà Machine Learning Tools</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># üìä Statistics &amp; Distributions</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> binom, norm, poisson, expon, skew, kurtosis, shapiro</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats.mstats <span class="im">import</span> winsorize</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># üìã Tabular Display</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>q tabulate  <span class="co"># -q suppresses pip output</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># üì∫ Display Tools</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, HTML</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats.mstats <span class="im">import</span> winsorize</span></code></pre></div>
</div>
<div class="cell markdown" id="_5jwYVUUJ6Vh">
<p>Connect Drive</p>
</div>
<div class="cell code" data-execution_count="4"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="EuUXd0q6JebJ" data-outputId="f07c4b40-9621-4360-d27e-2ab2bbbb344a">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Connect drive</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mounted at /content/drive
</code></pre>
</div>
</div>
<div class="cell markdown" id="4uFey7OYJ9Hq">
<p>Load CSV File / Dataset</p>
</div>
<div class="cell code" data-execution_count="5" id="2njwnObHJ_RT">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load CSV File</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>PBA_df <span class="op">=</span> pd.read_csv(<span class="st">&#39;/content/drive/MyDrive/Data Science/5. Applied Statistics/Mid Course/Superstore Marketing Data - Sheet1.csv&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;latin-1&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="6"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:444}"
id="vT_Ny3ci2oih" data-outputId="53440550-f305-488b-c639-a1b5c35e2683">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First look of Dataframe PBA_df</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>PBA_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">

  <div id="df-14e22403-a83f-47ee-8a9d-68b0e3f473ec" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Id</th>
      <th>Year_Birth</th>
      <th>Education</th>
      <th>Marital_Status</th>
      <th>Income</th>
      <th>Kidhome</th>
      <th>Teenhome</th>
      <th>Dt_Customer</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>...</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Response</th>
      <th>Complain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1826</td>
      <td>1970</td>
      <td>Graduation</td>
      <td>Divorced</td>
      <td>84835.0</td>
      <td>0</td>
      <td>0</td>
      <td>6/16/2014</td>
      <td>0</td>
      <td>189</td>
      <td>...</td>
      <td>111</td>
      <td>189</td>
      <td>218</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1961</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>57091.0</td>
      <td>0</td>
      <td>0</td>
      <td>6/15/2014</td>
      <td>0</td>
      <td>464</td>
      <td>...</td>
      <td>7</td>
      <td>0</td>
      <td>37</td>
      <td>1</td>
      <td>7</td>
      <td>3</td>
      <td>7</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10476</td>
      <td>1958</td>
      <td>Graduation</td>
      <td>Married</td>
      <td>67267.0</td>
      <td>0</td>
      <td>1</td>
      <td>5/13/2014</td>
      <td>0</td>
      <td>134</td>
      <td>...</td>
      <td>15</td>
      <td>2</td>
      <td>30</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1386</td>
      <td>1967</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>32474.0</td>
      <td>1</td>
      <td>1</td>
      <td>########</td>
      <td>0</td>
      <td>10</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5371</td>
      <td>1989</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>21474.0</td>
      <td>1</td>
      <td>0</td>
      <td>########</td>
      <td>0</td>
      <td>6</td>
      <td>...</td>
      <td>11</td>
      <td>0</td>
      <td>34</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2235</th>
      <td>10142</td>
      <td>1976</td>
      <td>PhD</td>
      <td>Divorced</td>
      <td>66476.0</td>
      <td>0</td>
      <td>1</td>
      <td>########</td>
      <td>99</td>
      <td>372</td>
      <td>...</td>
      <td>47</td>
      <td>48</td>
      <td>78</td>
      <td>2</td>
      <td>5</td>
      <td>2</td>
      <td>11</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2236</th>
      <td>5263</td>
      <td>1977</td>
      <td>2n Cycle</td>
      <td>Married</td>
      <td>31056.0</td>
      <td>1</td>
      <td>0</td>
      <td>1/22/2013</td>
      <td>99</td>
      <td>5</td>
      <td>...</td>
      <td>3</td>
      <td>8</td>
      <td>16</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2237</th>
      <td>22</td>
      <td>1976</td>
      <td>Graduation</td>
      <td>Divorced</td>
      <td>46310.0</td>
      <td>1</td>
      <td>0</td>
      <td>########</td>
      <td>99</td>
      <td>185</td>
      <td>...</td>
      <td>15</td>
      <td>5</td>
      <td>14</td>
      <td>2</td>
      <td>6</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2238</th>
      <td>528</td>
      <td>1978</td>
      <td>Graduation</td>
      <td>Married</td>
      <td>65819.0</td>
      <td>0</td>
      <td>0</td>
      <td>11/29/2012</td>
      <td>99</td>
      <td>267</td>
      <td>...</td>
      <td>149</td>
      <td>165</td>
      <td>63</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>10</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2239</th>
      <td>4070</td>
      <td>1969</td>
      <td>PhD</td>
      <td>Married</td>
      <td>94871.0</td>
      <td>0</td>
      <td>2</td>
      <td>########</td>
      <td>99</td>
      <td>169</td>
      <td>...</td>
      <td>188</td>
      <td>0</td>
      <td>144</td>
      <td>1</td>
      <td>8</td>
      <td>5</td>
      <td>4</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2240 rows √ó 22 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-14e22403-a83f-47ee-8a9d-68b0e3f473ec')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-14e22403-a83f-47ee-8a9d-68b0e3f473ec button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-14e22403-a83f-47ee-8a9d-68b0e3f473ec');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-987c2ead-f575-4de0-922a-d575955fac7b">
      <button class="colab-df-quickchart" onclick="quickchart('df-987c2ead-f575-4de0-922a-d575955fac7b')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-987c2ead-f575-4de0-922a-d575955fac7b button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_e8784708-a2af-4965-a000-195a097d0fc0">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('PBA_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_e8784708-a2af-4965-a000-195a097d0fc0 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('PBA_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="7"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="8kRksqB26f4g" data-outputId="02f70b11-df50-4a20-ca30-40047df4a7a8">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of rows and columns</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>rows, cols <span class="op">=</span> PBA_df.shape</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Number of rows: </span><span class="sc">{</span>rows<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Number of columns: </span><span class="sc">{</span>cols<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of rows: 2240
Number of columns: 22
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="7VNlwYS-2sta" data-outputId="427e5aca-19ef-43e3-b930-e4ccea2db163">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Summary of PBA_df</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(PBA_df.info())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2240 entries, 0 to 2239
Data columns (total 22 columns):
 #   Column               Non-Null Count  Dtype  
---  ------               --------------  -----  
 0   Id                   2240 non-null   int64  
 1   Year_Birth           2240 non-null   int64  
 2   Education            2240 non-null   object 
 3   Marital_Status       2240 non-null   object 
 4   Income               2216 non-null   float64
 5   Kidhome              2240 non-null   int64  
 6   Teenhome             2240 non-null   int64  
 7   Dt_Customer          2240 non-null   object 
 8   Recency              2240 non-null   int64  
 9   MntWines             2240 non-null   int64  
 10  MntFruits            2240 non-null   int64  
 11  MntMeatProducts      2240 non-null   int64  
 12  MntFishProducts      2240 non-null   int64  
 13  MntSweetProducts     2240 non-null   int64  
 14  MntGoldProds         2240 non-null   int64  
 15  NumDealsPurchases    2240 non-null   int64  
 16  NumWebPurchases      2240 non-null   int64  
 17  NumCatalogPurchases  2240 non-null   int64  
 18  NumStorePurchases    2240 non-null   int64  
 19  NumWebVisitsMonth    2240 non-null   int64  
 20  Response             2240 non-null   int64  
 21  Complain             2240 non-null   int64  
dtypes: float64(1), int64(18), object(3)
memory usage: 385.1+ KB
None
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="9"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="oYFxA_3u3amB" data-outputId="7d620114-bde4-47df-c5ad-afb417328cce">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(PBA_df.isnull().<span class="bu">sum</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Id                      0
Year_Birth              0
Education               0
Marital_Status          0
Income                 24
Kidhome                 0
Teenhome                0
Dt_Customer             0
Recency                 0
MntWines                0
MntFruits               0
MntMeatProducts         0
MntFishProducts         0
MntSweetProducts        0
MntGoldProds            0
NumDealsPurchases       0
NumWebPurchases         0
NumCatalogPurchases     0
NumStorePurchases       0
NumWebVisitsMonth       0
Response                0
Complain                0
dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:594}"
id="N3mAMVX_ll2L" data-outputId="7e081a9c-4f25-4939-922f-088e3ed81c3f">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze and Impute Income Column</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Visualize Income Distribution</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>sns.histplot(PBA_df[<span class="st">&#39;Income&#39;</span>], kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Income Distribution&#39;</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Income&#39;</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span>PBA_df[<span class="st">&#39;Income&#39;</span>], color<span class="op">=</span><span class="st">&#39;lightgreen&#39;</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Boxplot of Income&#39;</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Summary Statistics</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>income_mean <span class="op">=</span> PBA_df[<span class="st">&#39;Income&#39;</span>].mean()</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>income_median <span class="op">=</span> PBA_df[<span class="st">&#39;Income&#39;</span>].median()</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>income_mode <span class="op">=</span> PBA_df[<span class="st">&#39;Income&#39;</span>].mode()[<span class="dv">0</span>]</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>income_skew <span class="op">=</span> skew(PBA_df[<span class="st">&#39;Income&#39;</span>].dropna())</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Mean Income:&quot;</span>, <span class="bu">round</span>(income_mean, <span class="dv">2</span>))</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Median Income:&quot;</span>, <span class="bu">round</span>(income_median, <span class="dv">2</span>))</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Mode Income:&quot;</span>, income_mode)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Skewness:&quot;</span>, <span class="bu">round</span>(income_skew, <span class="dv">2</span>))</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Based on analysis, MEDIAN is the best method</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">‚úÖ Based on the skewed distribution, MEDIAN is selected to impute missing values.&quot;</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Confirm Imputation</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Missing values in &#39;Income&#39;&quot;</span>, PBA_df[<span class="st">&#39;Income&#39;</span>].isnull().<span class="bu">sum</span>())</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/315a72e32b69d5e49726b7f969119f68ca2e4253.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Mean Income: 52247.25
Median Income: 51381.5
Mode Income: 7500.0
Skewness: 6.76

‚úÖ Based on the skewed distribution, MEDIAN is selected to impute missing values.

Missing values in &#39;Income&#39; 24
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="11" id="PuApet_noodC">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>PBA_df[<span class="st">&#39;Income&#39;</span>] <span class="op">=</span> PBA_df[<span class="st">&#39;Income&#39;</span>].fillna(income_median)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="SGLMPB5dp5X5" data-outputId="7c14ae71-8536-46ed-8fe2-dc292c9ba01c">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Confirm Imputation</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Missing values in &#39;Income&#39; after imputation:&quot;</span>, PBA_df[<span class="st">&#39;Income&#39;</span>].isnull().<span class="bu">sum</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Missing values in &#39;Income&#39; after imputation: 0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="13" id="tFHX8UkU6_qw">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Add new &#39;Age&#39; Column to the df for better understanding</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate today&#39;s date</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>today <span class="op">=</span> datetime.today().year</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate age</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_age(year_birth):</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> today <span class="op">-</span> year_birth</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to create the &#39;Age&#39; column</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>PBA_df[<span class="st">&#39;Age&#39;</span>] <span class="op">=</span> PBA_df[<span class="st">&#39;Year_Birth&#39;</span>].<span class="bu">apply</span>(calculate_age)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ZjJfpkCMVIU7" data-outputId="eef786f3-d9dd-4a9c-f43f-25198fcd421f">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display &#39;Year_Birth&#39; and added column &#39;Age&#39;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(PBA_df[[<span class="st">&#39;Year_Birth&#39;</span>, <span class="st">&#39;Age&#39;</span>]])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>      Year_Birth  Age
0           1970   55
1           1961   64
2           1958   67
3           1967   58
4           1989   36
...          ...  ...
2235        1976   49
2236        1977   48
2237        1976   49
2238        1978   47
2239        1969   56

[2240 rows x 2 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="15" id="MvXXxMNsZzZR">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>PBA_df[<span class="st">&#39;TotalSpend&#39;</span>] <span class="op">=</span> PBA_df[[<span class="st">&#39;MntFishProducts&#39;</span>, <span class="st">&#39;MntMeatProducts&#39;</span>, <span class="st">&#39;MntFruits&#39;</span>, <span class="st">&#39;MntSweetProducts&#39;</span>, <span class="st">&#39;MntWines&#39;</span>, <span class="st">&#39;MntGoldProds&#39;</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="16"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:444}"
id="LlIjPxIFdhtG" data-outputId="26efd6fd-6202-47c0-fcc0-bcb4892a36a8">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Final look on df</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>PBA_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">

  <div id="df-2d8f7f1a-c068-4b7e-a299-5d386271f40e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Id</th>
      <th>Year_Birth</th>
      <th>Education</th>
      <th>Marital_Status</th>
      <th>Income</th>
      <th>Kidhome</th>
      <th>Teenhome</th>
      <th>Dt_Customer</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>...</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Response</th>
      <th>Complain</th>
      <th>Age</th>
      <th>TotalSpend</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1826</td>
      <td>1970</td>
      <td>Graduation</td>
      <td>Divorced</td>
      <td>84835.0</td>
      <td>0</td>
      <td>0</td>
      <td>6/16/2014</td>
      <td>0</td>
      <td>189</td>
      <td>...</td>
      <td>218</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>55</td>
      <td>1190</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1961</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>57091.0</td>
      <td>0</td>
      <td>0</td>
      <td>6/15/2014</td>
      <td>0</td>
      <td>464</td>
      <td>...</td>
      <td>37</td>
      <td>1</td>
      <td>7</td>
      <td>3</td>
      <td>7</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>64</td>
      <td>577</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10476</td>
      <td>1958</td>
      <td>Graduation</td>
      <td>Married</td>
      <td>67267.0</td>
      <td>0</td>
      <td>1</td>
      <td>5/13/2014</td>
      <td>0</td>
      <td>134</td>
      <td>...</td>
      <td>30</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>67</td>
      <td>251</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1386</td>
      <td>1967</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>32474.0</td>
      <td>1</td>
      <td>1</td>
      <td>########</td>
      <td>0</td>
      <td>10</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>58</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5371</td>
      <td>1989</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>21474.0</td>
      <td>1</td>
      <td>0</td>
      <td>########</td>
      <td>0</td>
      <td>6</td>
      <td>...</td>
      <td>34</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>36</td>
      <td>91</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2235</th>
      <td>10142</td>
      <td>1976</td>
      <td>PhD</td>
      <td>Divorced</td>
      <td>66476.0</td>
      <td>0</td>
      <td>1</td>
      <td>########</td>
      <td>99</td>
      <td>372</td>
      <td>...</td>
      <td>78</td>
      <td>2</td>
      <td>5</td>
      <td>2</td>
      <td>11</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>49</td>
      <td>689</td>
    </tr>
    <tr>
      <th>2236</th>
      <td>5263</td>
      <td>1977</td>
      <td>2n Cycle</td>
      <td>Married</td>
      <td>31056.0</td>
      <td>1</td>
      <td>0</td>
      <td>1/22/2013</td>
      <td>99</td>
      <td>5</td>
      <td>...</td>
      <td>16</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>48</td>
      <td>55</td>
    </tr>
    <tr>
      <th>2237</th>
      <td>22</td>
      <td>1976</td>
      <td>Graduation</td>
      <td>Divorced</td>
      <td>46310.0</td>
      <td>1</td>
      <td>0</td>
      <td>########</td>
      <td>99</td>
      <td>185</td>
      <td>...</td>
      <td>14</td>
      <td>2</td>
      <td>6</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>49</td>
      <td>309</td>
    </tr>
    <tr>
      <th>2238</th>
      <td>528</td>
      <td>1978</td>
      <td>Graduation</td>
      <td>Married</td>
      <td>65819.0</td>
      <td>0</td>
      <td>0</td>
      <td>11/29/2012</td>
      <td>99</td>
      <td>267</td>
      <td>...</td>
      <td>63</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>10</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>47</td>
      <td>1383</td>
    </tr>
    <tr>
      <th>2239</th>
      <td>4070</td>
      <td>1969</td>
      <td>PhD</td>
      <td>Married</td>
      <td>94871.0</td>
      <td>0</td>
      <td>2</td>
      <td>########</td>
      <td>99</td>
      <td>169</td>
      <td>...</td>
      <td>144</td>
      <td>1</td>
      <td>8</td>
      <td>5</td>
      <td>4</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>56</td>
      <td>1078</td>
    </tr>
  </tbody>
</table>
<p>2240 rows √ó 24 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2d8f7f1a-c068-4b7e-a299-5d386271f40e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2d8f7f1a-c068-4b7e-a299-5d386271f40e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2d8f7f1a-c068-4b7e-a299-5d386271f40e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-a7a2ad89-8e90-45f5-abea-d399cf4d7fd3">
      <button class="colab-df-quickchart" onclick="quickchart('df-a7a2ad89-8e90-45f5-abea-d399cf4d7fd3')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-a7a2ad89-8e90-45f5-abea-d399cf4d7fd3 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_66068275-7efb-4aeb-b70f-a60e03fcf6ff">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('PBA_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_66068275-7efb-4aeb-b70f-a60e03fcf6ff button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('PBA_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="17" id="ZgQdClFKiCu3">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the &#39;Dt_Customer&#39; column to datetime</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>PBA_df[<span class="st">&#39;Dt_Customer&#39;</span>] <span class="op">=</span> pd.to_datetime(PBA_df[<span class="st">&#39;Dt_Customer&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="2Sdce1mqij05" data-outputId="c9deedb9-c253-4964-cf52-4a5fb6f1eb11">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>missing_values <span class="op">=</span> PBA_df[<span class="st">&#39;Dt_Customer&#39;</span>].isnull().<span class="bu">sum</span>()</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_values)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>916
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:815}"
id="_7nupgaWvEDL" data-outputId="5087afba-4c93-474e-b240-efffb1475f80">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column to analyze for Method to be used for Imputation for Dt_Customer</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>date_column <span class="op">=</span> <span class="st">&#39;Dt_Customer&#39;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Check for skewness</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>skewness <span class="op">=</span> PBA_df[date_column].dropna().<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.timestamp()).skew()</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Plot the distribution</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>sns.histplot(PBA_df[date_column].dropna(), kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Distribution of </span><span class="sc">{</span>date_column<span class="sc">}</span><span class="ss"> (Without Missing Values)&quot;</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(date_column)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Frequency&quot;</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate mode, count, and percentage</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>mode_value <span class="op">=</span> PBA_df[date_column].mode()[<span class="dv">0</span>]</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>mode_count <span class="op">=</span> PBA_df[date_column].value_counts()[mode_value]</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>total_count <span class="op">=</span> PBA_df[date_column].notna().<span class="bu">sum</span>()</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>mode_percentage <span class="op">=</span> (mode_count <span class="op">/</span> total_count) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>median_value <span class="op">=</span> PBA_df[date_column].median()</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Final report with recommendation</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;### üóÇ Column Analyzed: &#39;Dt_Customer&#39;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;- üìÖ Most Frequent Date (Mode): </span><span class="sc">{</span>mode_value<span class="sc">.</span>date()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;- üî¢ Occurrences of Mode: </span><span class="sc">{</span>mode_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;- üìä Percentage of Mode in Total Non-Null Rows: </span><span class="sc">{</span>mode_percentage<span class="sc">:.2f}</span><span class="ss">%&quot;</span>)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;- üìà Skewness of Data: </span><span class="sc">{</span>skewness<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">&quot;</span>)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;#### ‚úÖ Conclusion:&quot;</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">abs</span>(skewness) <span class="op">&gt;</span> <span class="fl">0.5</span>:</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;- The data is **skewed**.&quot;</span>)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;- The mode appears in less than 10</span><span class="sc">% o</span><span class="st">f the data and does not dominate.&quot;</span>)</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;### üîß Recommended Imputation Method:&quot;</span>)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;üëâ Use the **median date** ‚Üí </span><span class="sc">{</span>median_value<span class="sc">.</span>date()<span class="sc">}</span><span class="ss"> for imputing missing values in &#39;Dt_Customer&#39;.&quot;</span>)</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> mode_percentage <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;- The data has a **dominant date value**.&quot;</span>)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;### üîß Recommended Imputation Method:&quot;</span>)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;üëâ Use the **mode date** ‚Üí </span><span class="sc">{</span>mode_value<span class="sc">.</span>date()<span class="sc">}</span><span class="ss"> for imputing missing values in &#39;Dt_Customer&#39;.&quot;</span>)</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;- The data is **relatively balanced**.&quot;</span>)</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;- There is **no clear skew or dominant mode**.&quot;</span>)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;### üîß Recommended Imputation Method:&quot;</span>)</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;üëâ Use the **median date** ‚Üí </span><span class="sc">{</span>median_value<span class="sc">.</span>date()<span class="sc">}</span><span class="ss"> for imputing missing values in &#39;Dt_Customer&#39;.&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/e818c749753a987173e24eb138016c0f1a138e48.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>### üóÇ Column Analyzed: &#39;Dt_Customer&#39;

- üìÖ Most Frequent Date (Mode): 2012-08-31
- üî¢ Occurrences of Mode: 12
- üìä Percentage of Mode in Total Non-Null Rows: 0.91%
- üìà Skewness of Data: -0.01

#### ‚úÖ Conclusion:
- The data is **relatively balanced**.
- There is **no clear skew or dominant mode**.
### üîß Recommended Imputation Method:
üëâ Use the **median date** ‚Üí 2013-07-21 for imputing missing values in &#39;Dt_Customer&#39;.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="p9lYBzTjzKf8" data-outputId="0f21679d-d979-4779-e70f-3f5cf79810e9">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Calculate the median date</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>median_date <span class="op">=</span> PBA_df[<span class="st">&#39;Dt_Customer&#39;</span>].median()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Impute missing values with the median date</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>PBA_df[<span class="st">&#39;Dt_Customer&#39;</span>] <span class="op">=</span> PBA_df[<span class="st">&#39;Dt_Customer&#39;</span>].fillna(median_date)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Optional - Confirm imputation</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Missing values after imputation: </span><span class="sc">{</span>PBA_df[<span class="st">&#39;Dt_Customer&#39;</span>]<span class="sc">.</span>isnull()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;üïì Median date used for imputation: </span><span class="sc">{</span>median_date<span class="sc">.</span>date()<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>‚úÖ Missing values after imputation: 0
üïì Median date used for imputation: 2013-07-21
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="IiVH9XF5_0jU" data-outputId="354f768d-e161-4efc-f3c1-57fdd2e4f4aa">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze the distribution of customer demographics</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Age distribution</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sns.histplot(PBA_df[<span class="st">&#39;Age&#39;</span>], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Customer Age&#39;</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Age&#39;</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(PBA_df[<span class="st">&#39;Age&#39;</span>].describe())</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Education distribution</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&#39;Education&#39;</span>, data<span class="op">=</span>PBA_df)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Customer Education&#39;</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Education Level&#39;</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(PBA_df[<span class="st">&#39;Education&#39;</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Marital status distribution</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the column name is &#39;Marital_Status&#39; instead of &#39;Marital&#39;</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&#39;Marital_Status&#39;</span>, data<span class="op">=</span>PBA_df)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Customer Marital Status&#39;</span>)</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Marital Status&#39;</span>)</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(PBA_df[<span class="st">&#39;Marital_Status&#39;</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">*</span> <span class="dv">100</span>) <span class="co"># Print with corrected column name if applicable</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/f8a908ac404db2a124850f27538feb46981f47cb.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>count    2240.000000
mean       56.194196
std        11.984069
min        29.000000
25%        48.000000
50%        55.000000
75%        66.000000
max       132.000000
Name: Age, dtype: float64
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/d531dc1ab13a9ee4d805f440276a82ef5b3753ae.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Education
Graduation    50.312500
PhD           21.696429
Master        16.517857
2n Cycle       9.062500
Basic          2.410714
Name: proportion, dtype: float64
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/9b3dc46ed04cd5ce9e086ec7b481af0ab8b1a6bb.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Marital_Status
Married     38.571429
Together    25.892857
Single      21.428571
Divorced    10.357143
Widow        3.437500
Alone        0.133929
YOLO         0.089286
Absurd       0.089286
Name: proportion, dtype: float64
</code></pre>
</div>
</div>
<div class="cell markdown" id="9x5-gaDNaiUK">
<p>##Task 2 - Descriptive Statistics üìä</p>
<ul>
<li><strong>Calculate measures of central tendency (mean, median, mode)
and measures of dispersion (variance, standard deviation) for key
variables. Identify and handle outliers if necessary.</strong></li>
</ul>
</div>
<div class="cell markdown" id="9B6cMM0AamkO">
<p><strong>Deliverables</strong>:</p>
<ul>
<li><strong>Descriptive statistics that reveal the central tendencies,
variations, and potential outliers in the dataset.</strong>:</li>
</ul>
</div>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:708}"
id="3UO8SWku6GGe" data-outputId="60fa8799-7749-4ab2-c73e-ce6faf2fd22e">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Descriptive statistics</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select all numerical columns</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>numerical_cols <span class="op">=</span> PBA_df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int64&#39;</span>, <span class="st">&#39;float64&#39;</span>]).columns</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate descriptive statistics</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>statistics <span class="op">=</span> {}</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numerical_cols:</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    mean <span class="op">=</span> PBA_df[col].mean()</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    median <span class="op">=</span> PBA_df[col].median()</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    mode <span class="op">=</span> PBA_df[col].mode()[<span class="dv">0</span>] <span class="cf">if</span> <span class="kw">not</span> PBA_df[col].mode().empty <span class="cf">else</span> np.nan</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    variance <span class="op">=</span> PBA_df[col].var()</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    std_dev <span class="op">=</span> PBA_df[col].std()</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    statistics[col] <span class="op">=</span> {</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Mean&#39;</span>: mean,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Median&#39;</span>: median,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Mode&#39;</span>: mode,</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Variance&#39;</span>: variance,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Standard Deviation&#39;</span>: std_dev</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DataFrame</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>stats_df <span class="op">=</span> pd.DataFrame(statistics).T</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the table</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>display(stats_df)</span></code></pre></div>
<div class="output display_data">

  <div id="df-18cd0420-3790-437d-9461-11350b244a7e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Mean</th>
      <th>Median</th>
      <th>Mode</th>
      <th>Variance</th>
      <th>Standard Deviation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Id</th>
      <td>5592.159821</td>
      <td>5458.5</td>
      <td>0.0</td>
      <td>1.054082e+07</td>
      <td>3246.662198</td>
    </tr>
    <tr>
      <th>Year_Birth</th>
      <td>1968.805804</td>
      <td>1970.0</td>
      <td>1976.0</td>
      <td>1.436179e+02</td>
      <td>11.984069</td>
    </tr>
    <tr>
      <th>Income</th>
      <td>52237.975446</td>
      <td>51381.5</td>
      <td>51381.5</td>
      <td>6.268992e+08</td>
      <td>25037.955891</td>
    </tr>
    <tr>
      <th>Kidhome</th>
      <td>0.444196</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.898725e-01</td>
      <td>0.538398</td>
    </tr>
    <tr>
      <th>Teenhome</th>
      <td>0.506250</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.965219e-01</td>
      <td>0.544538</td>
    </tr>
    <tr>
      <th>Recency</th>
      <td>49.109375</td>
      <td>49.0</td>
      <td>56.0</td>
      <td>8.388237e+02</td>
      <td>28.962453</td>
    </tr>
    <tr>
      <th>MntWines</th>
      <td>303.935714</td>
      <td>173.5</td>
      <td>2.0</td>
      <td>1.132978e+05</td>
      <td>336.597393</td>
    </tr>
    <tr>
      <th>MntFruits</th>
      <td>26.302232</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>1.581926e+03</td>
      <td>39.773434</td>
    </tr>
    <tr>
      <th>MntMeatProducts</th>
      <td>166.950000</td>
      <td>67.0</td>
      <td>7.0</td>
      <td>5.094743e+04</td>
      <td>225.715373</td>
    </tr>
    <tr>
      <th>MntFishProducts</th>
      <td>37.525446</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>2.984325e+03</td>
      <td>54.628979</td>
    </tr>
    <tr>
      <th>MntSweetProducts</th>
      <td>27.062946</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>1.704080e+03</td>
      <td>41.280498</td>
    </tr>
    <tr>
      <th>MntGoldProds</th>
      <td>44.021875</td>
      <td>24.0</td>
      <td>1.0</td>
      <td>2.721442e+03</td>
      <td>52.167439</td>
    </tr>
    <tr>
      <th>NumDealsPurchases</th>
      <td>2.325000</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.733542e+00</td>
      <td>1.932238</td>
    </tr>
    <tr>
      <th>NumWebPurchases</th>
      <td>4.084821</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>7.721252e+00</td>
      <td>2.778714</td>
    </tr>
    <tr>
      <th>NumCatalogPurchases</th>
      <td>2.662054</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>8.544517e+00</td>
      <td>2.923101</td>
    </tr>
    <tr>
      <th>NumStorePurchases</th>
      <td>5.790179</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>1.056873e+01</td>
      <td>3.250958</td>
    </tr>
    <tr>
      <th>NumWebVisitsMonth</th>
      <td>5.316518</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>5.888606e+00</td>
      <td>2.426645</td>
    </tr>
    <tr>
      <th>Response</th>
      <td>0.149107</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.269309e-01</td>
      <td>0.356274</td>
    </tr>
    <tr>
      <th>Complain</th>
      <td>0.009375</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.291257e-03</td>
      <td>0.096391</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>56.194196</td>
      <td>55.0</td>
      <td>49.0</td>
      <td>1.436179e+02</td>
      <td>11.984069</td>
    </tr>
    <tr>
      <th>TotalSpend</th>
      <td>605.798214</td>
      <td>396.0</td>
      <td>46.0</td>
      <td>3.627042e+05</td>
      <td>602.249288</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-18cd0420-3790-437d-9461-11350b244a7e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-18cd0420-3790-437d-9461-11350b244a7e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-18cd0420-3790-437d-9461-11350b244a7e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-7f8fd77c-5761-4e0a-8b79-9a30ddd034e7">
      <button class="colab-df-quickchart" onclick="quickchart('df-7f8fd77c-5761-4e0a-8b79-9a30ddd034e7')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-7f8fd77c-5761-4e0a-8b79-9a30ddd034e7 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_c11e689f-7439-4e6e-84a2-ae0a4318c811">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('stats_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_c11e689f-7439-4e6e-84a2-ae0a4318c811 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('stats_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="23"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:607}"
id="0Q0dNFcr6qW-" data-outputId="f0fdad75-801b-49a3-c6aa-d5e5516a51ba">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#Box plot of outliers in various columns</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select numerical columns (excluding &#39;ID&#39;)</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>numerical_cols <span class="op">=</span> PBA_df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;number&#39;</span>]).drop(columns<span class="op">=</span>[<span class="st">&#39;ID&#39;</span>], errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>).columns[:<span class="dv">16</span>]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 4x4 subplots with a much smaller figure size</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">4</span>, ncols<span class="op">=</span><span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))  <span class="co"># Much smaller</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plots</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(numerical_cols):</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    sns.boxplot(x<span class="op">=</span>PBA_df[col], ax<span class="op">=</span>axes[i])</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    axes[i].set_title(<span class="ss">f&#39;</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;</span>, fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(<span class="st">&#39;&#39;</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    axes[i].tick_params(labelsize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide any unused subplots</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(axes)):</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    axes[j].axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/e9f155095e6aad95e2bd5ac1991a795b282021c1.png" /></p>
</div>
</div>
<section id="finding-method-to-be-used-for-outliers-handling"
class="cell markdown" id="S2pljYrAPyQW">
<h3><strong>Finding method to be used for Outliers
handling</strong></h3>
</section>
<div class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="7nLVr6ONPvtY" data-outputId="31c65261-8197-496e-fb75-3f839ae6f7f9">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding Best Method for Handling Outliers</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select numerical columns for analysis</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>num_cols <span class="op">=</span> PBA_df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;float64&#39;</span>, <span class="st">&#39;int64&#39;</span>]).columns</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize counters for outlier categories</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>mild_outlier_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>severe_outlier_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the stats module is imported</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np <span class="co"># Also ensure numpy is imported as it&#39;s used with np.abs</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper functions for outlier detection</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_outliers_iqr(column):</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    Q1 <span class="op">=</span> column.quantile(<span class="fl">0.25</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    Q3 <span class="op">=</span> column.quantile(<span class="fl">0.75</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    lower <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    upper <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lower, upper, (column <span class="op">&lt;</span> lower) <span class="op">|</span> (column <span class="op">&gt;</span> upper)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_outliers_zscore(column, threshold<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    z_scores <span class="op">=</span> np.<span class="bu">abs</span>(stats.zscore(column, nan_policy<span class="op">=</span><span class="st">&#39;omit&#39;</span>))</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> z_scores <span class="op">&gt;</span> threshold</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> apply_winsorization(column, lower_percentile<span class="op">=</span><span class="fl">0.01</span>, upper_percentile<span class="op">=</span><span class="fl">0.99</span>):</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    lower_limit <span class="op">=</span> column.quantile(lower_percentile)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    upper_limit <span class="op">=</span> column.quantile(upper_percentile)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> column.clip(lower<span class="op">=</span>lower_limit, upper<span class="op">=</span>upper_limit)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluation of all methods</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>outlier_details <span class="op">=</span> {}</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> num_cols:</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the column has non-null values to avoid errors with empty columns</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> PBA_df[col].notna().<span class="bu">sum</span>() <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Skipping outlier analysis for empty column: </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># IQR Method</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure column has at least 2 non-null values for quantile calculation</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> PBA_df[col].notna().<span class="bu">sum</span>() <span class="op">&gt;=</span> <span class="dv">2</span>:</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>        lower_iqr, upper_iqr, iqr_outliers <span class="op">=</span> calculate_outliers_iqr(PBA_df[col])</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>        iqr_outlier_count <span class="op">=</span> iqr_outliers.<span class="bu">sum</span>()</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>        iqr_outlier_count <span class="op">=</span> <span class="dv">0</span> <span class="co"># No outliers if less than 2 data points</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Z-Score Method</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure column has at least 2 non-null values for zscore calculation</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> PBA_df[col].notna().<span class="bu">sum</span>() <span class="op">&gt;=</span> <span class="dv">2</span>:</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>        zscore_outliers <span class="op">=</span> calculate_outliers_zscore(PBA_df[col])</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>        zscore_outlier_count <span class="op">=</span> zscore_outliers.<span class="bu">sum</span>()</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>        zscore_outlier_count <span class="op">=</span> <span class="dv">0</span> <span class="co"># No outliers if less than 2 data points</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Winsorization (applying capping)</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure column has non-null values before applying winsorization</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> PBA_df[col].notna().<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>        winsorized_column <span class="op">=</span> apply_winsorization(PBA_df[col])</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>        winsorized_outliers <span class="op">=</span> (PBA_df[col] <span class="op">!=</span> winsorized_column).<span class="bu">sum</span>()</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>        winsorized_outliers <span class="op">=</span> <span class="dv">0</span> <span class="co"># No outliers if no data points</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Outlier ratio (outliers relative to non-null entries)</span></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>    total_non_null_entries <span class="op">=</span> PBA_df[col].notna().<span class="bu">sum</span>()</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>    outlier_ratio_iqr <span class="op">=</span> iqr_outlier_count <span class="op">/</span> total_non_null_entries <span class="cf">if</span> total_non_null_entries <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>    outlier_ratio_zscore <span class="op">=</span> zscore_outlier_count <span class="op">/</span> total_non_null_entries <span class="cf">if</span> total_non_null_entries <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>    outlier_ratio_winsorization <span class="op">=</span> winsorized_outliers <span class="op">/</span> total_non_null_entries <span class="cf">if</span> total_non_null_entries <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Track results for decision making</span></span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>    outlier_details[col] <span class="op">=</span> {</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;IQR Outliers&quot;</span>: iqr_outlier_count,</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Z-Score Outliers&quot;</span>: zscore_outlier_count,</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Winsorization Outliers&quot;</span>: winsorized_outliers,</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Outlier Ratio IQR&quot;</span>: outlier_ratio_iqr,</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Outlier Ratio Z-Score&quot;</span>: outlier_ratio_zscore,</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Outlier Ratio Winsorization&quot;</span>: outlier_ratio_winsorization</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Total summary of outlier methods across all columns</span></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>total_outliers_iqr <span class="op">=</span> <span class="bu">sum</span>([outlier_details[col][<span class="st">&quot;IQR Outliers&quot;</span>] <span class="cf">for</span> col <span class="kw">in</span> num_cols <span class="cf">if</span> col <span class="kw">in</span> outlier_details])</span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>total_outliers_zscore <span class="op">=</span> <span class="bu">sum</span>([outlier_details[col][<span class="st">&quot;Z-Score Outliers&quot;</span>] <span class="cf">for</span> col <span class="kw">in</span> num_cols <span class="cf">if</span> col <span class="kw">in</span> outlier_details])</span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>total_outliers_winsorization <span class="op">=</span> <span class="bu">sum</span>([outlier_details[col][<span class="st">&quot;Winsorization Outliers&quot;</span>] <span class="cf">for</span> col <span class="kw">in</span> num_cols <span class="cf">if</span> col <span class="kw">in</span> outlier_details])</span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Suggesting best method based on criteria</span></span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a>threshold_for_mild_outliers <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a>threshold_for_severe_outliers <span class="op">=</span> <span class="fl">0.15</span></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of columns with outliers based on IQR, Z-Score, and Winsorization</span></span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a>mild_outliers <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> col <span class="kw">in</span> num_cols <span class="cf">if</span> col <span class="kw">in</span> outlier_details <span class="kw">and</span> outlier_details[col][<span class="st">&quot;Outlier Ratio IQR&quot;</span>] <span class="op">&gt;</span> threshold_for_mild_outliers)</span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>severe_outliers <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> col <span class="kw">in</span> num_cols <span class="cf">if</span> col <span class="kw">in</span> outlier_details <span class="kw">and</span> outlier_details[col][<span class="st">&quot;Outlier Ratio IQR&quot;</span>] <span class="op">&gt;</span> threshold_for_severe_outliers)</span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision logic considering business context and outlier severity</span></span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> severe_outliers <span class="op">&gt;</span> <span class="bu">len</span>(num_cols) <span class="op">*</span> <span class="fl">0.3</span>:</span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Suggested outlier-handling method for PBA_df: Transformation (log/sqrt)&quot;</span>)</span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> mild_outliers <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adding business context: Retail/Purchasing market where extreme values represent genuine customers</span></span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Suggested outlier-handling method for PBA_df: Winsorization (capping).&quot;</span>)</span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;&quot;&quot;This is a retail/purchasing dataset, where extreme values often represent genuine high-spending customers,</span></span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a><span class="st">and removing them could result in loss of important information. Hence, Winsorization is a more suitable approach.&quot;&quot;&quot;</span>)</span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Suggested outlier-handling method for PBA_df: No action needed&quot;</span>)</span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the summary of the outlier methods</span></span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Outlier detection summary across all numerical columns:&quot;</span>)</span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total Outliers (IQR): </span><span class="sc">{</span>total_outliers_iqr<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total Outliers (Z-Score): </span><span class="sc">{</span>total_outliers_zscore<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total Outliers (Winsorization): </span><span class="sc">{</span>total_outliers_winsorization<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Suggested outlier-handling method for PBA_df: Winsorization (capping).


This is a retail/purchasing dataset, where extreme values often represent genuine high-spending customers,
and removing them could result in loss of important information. Hence, Winsorization is a more suitable approach.

Outlier detection summary across all numerical columns:
Total Outliers (IQR): 1608
Total Outliers (Z-Score): 370
Total Outliers (Winsorization): 493
</code></pre>
</div>
</div>
<div class="cell markdown" id="kqnD6uKXUM62">
<p>###<strong>Handling Outliers</strong></p>
</div>
<div class="cell code" data-execution_count="25" id="pC3GI1AR5Xq_">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Winsozarion for handling Outliers</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> winsorize_outliers(df, columns, limits<span class="op">=</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>)):</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Applies Winsorization to specified columns in a DataFrame.&quot;&quot;&quot;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    df_winsorized <span class="op">=</span> df.copy()</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> columns:</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>        lower <span class="op">=</span> df[col].quantile(limits[<span class="dv">0</span>])</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        upper <span class="op">=</span> df[col].quantile(limits[<span class="dv">1</span>])</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        df_winsorized[col] <span class="op">=</span> np.clip(df[col], lower, upper)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_winsorized</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>columns_to_winsorize <span class="op">=</span> [</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Income&#39;</span>, <span class="st">&#39;MntWines&#39;</span>, <span class="st">&#39;MntFruits&#39;</span>, <span class="st">&#39;MntMeatProducts&#39;</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;MntFishProducts&#39;</span>, <span class="st">&#39;MntSweetProducts&#39;</span>, <span class="st">&#39;MntGoldProds&#39;</span>,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;NumDealsPurchases&#39;</span>, <span class="st">&#39;NumWebPurchases&#39;</span>, <span class="st">&#39;NumCatalogPurchases&#39;</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;NumStorePurchases&#39;</span>, <span class="st">&#39;NumWebVisitsMonth&#39;</span>, <span class="st">&#39;Recency&#39;</span>, <span class="st">&#39;Age&#39;</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>PBA_df_winsorized <span class="op">=</span> winsorize_outliers(PBA_df, columns_to_winsorize)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="26" id="0Ko_O7Tzk9Ba">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Winsozarion for handling Outliers</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> winsorize_outliers(df, columns, limits<span class="op">=</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>)):</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Applies Winsorization to specified columns in a DataFrame.&quot;&quot;&quot;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    df_winsorized <span class="op">=</span> df.copy()</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> columns:</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check if the column exists before trying to winsorize</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="kw">in</span> df_winsorized.columns:</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>            lower <span class="op">=</span> df_winsorized[col].quantile(limits[<span class="dv">0</span>])</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>            upper <span class="op">=</span> df_winsorized[col].quantile(limits[<span class="dv">1</span>])</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>            df_winsorized[col] <span class="op">=</span> np.clip(df_winsorized[col], lower, upper)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Warning: Column &#39;</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39; not found in DataFrame for winsorization.&quot;</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_winsorized</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>columns_to_winsorize <span class="op">=</span> [</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Income&#39;</span>, <span class="st">&#39;MntWines&#39;</span>, <span class="st">&#39;MntFruits&#39;</span>, <span class="st">&#39;MntMeatProducts&#39;</span>,</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;MntFishProducts&#39;</span>, <span class="st">&#39;MntSweetProducts&#39;</span>, <span class="st">&#39;MntGoldProds&#39;</span>,</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;NumDealsPurchases&#39;</span>, <span class="st">&#39;NumWebPurchases&#39;</span>, <span class="st">&#39;NumCatalogPurchases&#39;</span>,</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;NumStorePurchases&#39;</span>, <span class="st">&#39;NumWebVisitsMonth&#39;</span>, <span class="st">&#39;Recency&#39;</span>, <span class="st">&#39;Age&#39;</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>PBA_df_winsorized <span class="op">=</span> winsorize_outliers(PBA_df, columns_to_winsorize)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate &#39;TotalSpend&#39; after Winsorization using the winsorized spending columns</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure these columns exist in the winsorized dataframe before summing</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>spending_cols <span class="op">=</span> [<span class="st">&#39;MntFishProducts&#39;</span>, <span class="st">&#39;MntMeatProducts&#39;</span>, <span class="st">&#39;MntFruits&#39;</span>, <span class="st">&#39;MntSweetProducts&#39;</span>, <span class="st">&#39;MntWines&#39;</span>, <span class="st">&#39;MntGoldProds&#39;</span>]</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if spending columns exist in the winsorized dataframe before summing</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>existing_spending_cols <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> spending_cols <span class="cf">if</span> col <span class="kw">in</span> PBA_df_winsorized.columns]</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> existing_spending_cols:</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>    PBA_df_winsorized[<span class="st">&#39;TotalSpend&#39;</span>] <span class="op">=</span> PBA_df_winsorized[existing_spending_cols].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Warning: No spending columns found in PBA_df_winsorized to calculate TotalSpend.&quot;</span>)</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div class="cell markdown" id="zBOCDOsrk8r7">

</div>
<div class="cell markdown" id="EFKrvyrjUSOh">
<p>###<strong>Box plot after handling Outliers</strong></p>
</div>
<div class="cell code" data-execution_count="27"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:607}"
id="4XcjiyDb1omA" data-outputId="e9911324-04f5-46e4-f1fb-b4145937a724">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create subplots for box plots after winsorization</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">4</span>, ncols<span class="op">=</span><span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through numerical columns and create box plots for winsorized data</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(columns_to_winsorize):</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(axes):</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        sns.boxplot(x<span class="op">=</span>PBA_df_winsorized[col], ax<span class="op">=</span>axes[i])</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        axes[i].set_title(<span class="ss">f&#39;</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss"> (Winsorized)&#39;</span>, fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>        axes[i].set_xlabel(<span class="st">&#39;&#39;</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>        axes[i].tick_params(labelsize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide any unused subplots</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(axes)):</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    axes[j].axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/2d751ce1d14e0ae1320b46b4b6f0c4f41af57378.png" /></p>
</div>
</div>
<div class="cell markdown" id="qfcY96zGUauu">
<p>###<strong>Descriptive Statistics comparison after
Winsorization</strong></p>
</div>
<div class="cell code" data-execution_count="28"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:743}"
id="yjasKFpv2WI8" data-outputId="e4c9fdf3-6018-41e3-de6d-422a8e9e1267">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select numerical columns</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>numerical_cols <span class="op">=</span> PBA_df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int64&#39;</span>, <span class="st">&#39;float64&#39;</span>]).columns</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to compute statistics</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_statistics(df):</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">=</span> {}</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> numerical_cols:</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>        mode_val <span class="op">=</span> df[col].mode()[<span class="dv">0</span>] <span class="cf">if</span> <span class="kw">not</span> df[col].mode().empty <span class="cf">else</span> np.nan</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>        stats[col] <span class="op">=</span> {</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Mean&#39;</span>: df[col].mean(),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Median&#39;</span>: df[col].median(),</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Mode&#39;</span>: mode_val,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Variance&#39;</span>: df[col].var(),</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Standard Deviation&#39;</span>: df[col].std()</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(stats).T</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Stats before Winsorization</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>stats_before <span class="op">=</span> get_statistics(PBA_df)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Winsorization (limit 5% on each side)</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>winsorized_df <span class="op">=</span> PBA_df.copy()</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numerical_cols:</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    winsorized_data <span class="op">=</span> winsorize(PBA_df[col], limits<span class="op">=</span>[<span class="fl">0.05</span>, <span class="fl">0.05</span>])</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    winsorized_df[col] <span class="op">=</span> winsorized_data</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Stats after Winsorization</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>stats_after <span class="op">=</span> get_statistics(winsorized_df)</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine both for comparison</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>combined_stats <span class="op">=</span> pd.DataFrame()</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> stat <span class="kw">in</span> [<span class="st">&#39;Mean&#39;</span>, <span class="st">&#39;Median&#39;</span>, <span class="st">&#39;Mode&#39;</span>, <span class="st">&#39;Variance&#39;</span>, <span class="st">&#39;Standard Deviation&#39;</span>]:</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>    combined_stats[<span class="ss">f&#39;</span><span class="sc">{</span>stat<span class="sc">}</span><span class="ss"> (Before)&#39;</span>] <span class="op">=</span> stats_before[stat]</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    combined_stats[<span class="ss">f&#39;</span><span class="sc">{</span>stat<span class="sc">}</span><span class="ss"> (After)&#39;</span>] <span class="op">=</span> stats_after[stat]</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the final comparison table</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>display(combined_stats)</span></code></pre></div>
<div class="output display_data">

  <div id="df-e9ecd064-9eae-4537-b7e9-5ace3639898c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Mean (Before)</th>
      <th>Mean (After)</th>
      <th>Median (Before)</th>
      <th>Median (After)</th>
      <th>Mode (Before)</th>
      <th>Mode (After)</th>
      <th>Variance (Before)</th>
      <th>Variance (After)</th>
      <th>Standard Deviation (Before)</th>
      <th>Standard Deviation (After)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Id</th>
      <td>5592.159821</td>
      <td>5594.921875</td>
      <td>5458.5</td>
      <td>5458.5</td>
      <td>0.0</td>
      <td>577.0</td>
      <td>1.054082e+07</td>
      <td>1.026318e+07</td>
      <td>3246.662198</td>
      <td>3203.619651</td>
    </tr>
    <tr>
      <th>Year_Birth</th>
      <td>1968.805804</td>
      <td>1968.910714</td>
      <td>1970.0</td>
      <td>1970.0</td>
      <td>1976.0</td>
      <td>1950.0</td>
      <td>1.436179e+02</td>
      <td>1.260715e+02</td>
      <td>11.984069</td>
      <td>11.228158</td>
    </tr>
    <tr>
      <th>Income</th>
      <td>52237.975446</td>
      <td>51743.179911</td>
      <td>51381.5</td>
      <td>51381.5</td>
      <td>51381.5</td>
      <td>19107.0</td>
      <td>6.268992e+08</td>
      <td>3.857132e+08</td>
      <td>25037.955891</td>
      <td>19639.582044</td>
    </tr>
    <tr>
      <th>Kidhome</th>
      <td>0.444196</td>
      <td>0.422768</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.898725e-01</td>
      <td>2.441442e-01</td>
      <td>0.538398</td>
      <td>0.494109</td>
    </tr>
    <tr>
      <th>Teenhome</th>
      <td>0.506250</td>
      <td>0.483036</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.965219e-01</td>
      <td>2.498237e-01</td>
      <td>0.544538</td>
      <td>0.499824</td>
    </tr>
    <tr>
      <th>Recency</th>
      <td>49.109375</td>
      <td>49.094643</td>
      <td>49.0</td>
      <td>49.0</td>
      <td>56.0</td>
      <td>4.0</td>
      <td>8.388237e+02</td>
      <td>8.150344e+02</td>
      <td>28.962453</td>
      <td>28.548807</td>
    </tr>
    <tr>
      <th>MntWines</th>
      <td>303.935714</td>
      <td>295.352679</td>
      <td>173.5</td>
      <td>173.5</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>1.132978e+05</td>
      <td>9.869085e+04</td>
      <td>336.597393</td>
      <td>314.151003</td>
    </tr>
    <tr>
      <th>MntFruits</th>
      <td>26.302232</td>
      <td>24.774107</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.581926e+03</td>
      <td>1.215066e+03</td>
      <td>39.773434</td>
      <td>34.857790</td>
    </tr>
    <tr>
      <th>MntMeatProducts</th>
      <td>166.950000</td>
      <td>159.041964</td>
      <td>67.0</td>
      <td>67.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>5.094743e+04</td>
      <td>3.944467e+04</td>
      <td>225.715373</td>
      <td>198.606827</td>
    </tr>
    <tr>
      <th>MntFishProducts</th>
      <td>37.525446</td>
      <td>35.656696</td>
      <td>12.0</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.984325e+03</td>
      <td>2.391898e+03</td>
      <td>54.628979</td>
      <td>48.907031</td>
    </tr>
    <tr>
      <th>MntSweetProducts</th>
      <td>27.062946</td>
      <td>25.435268</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.704080e+03</td>
      <td>1.295957e+03</td>
      <td>41.280498</td>
      <td>35.999396</td>
    </tr>
    <tr>
      <th>MntGoldProds</th>
      <td>44.021875</td>
      <td>42.175893</td>
      <td>24.0</td>
      <td>24.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.721442e+03</td>
      <td>2.139522e+03</td>
      <td>52.167439</td>
      <td>46.254962</td>
    </tr>
    <tr>
      <th>NumDealsPurchases</th>
      <td>2.325000</td>
      <td>2.236161</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.733542e+00</td>
      <td>2.296593e+00</td>
      <td>1.932238</td>
      <td>1.515451</td>
    </tr>
    <tr>
      <th>NumWebPurchases</th>
      <td>4.084821</td>
      <td>4.018750</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>7.721252e+00</td>
      <td>6.105946e+00</td>
      <td>2.778714</td>
      <td>2.471021</td>
    </tr>
    <tr>
      <th>NumCatalogPurchases</th>
      <td>2.662054</td>
      <td>2.592411</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.544517e+00</td>
      <td>7.041925e+00</td>
      <td>2.923101</td>
      <td>2.653663</td>
    </tr>
    <tr>
      <th>NumStorePurchases</th>
      <td>5.790179</td>
      <td>5.769643</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.056873e+01</td>
      <td>9.915648e+00</td>
      <td>3.250958</td>
      <td>3.148912</td>
    </tr>
    <tr>
      <th>NumWebVisitsMonth</th>
      <td>5.316518</td>
      <td>5.244196</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>5.888606e+00</td>
      <td>4.998403e+00</td>
      <td>2.426645</td>
      <td>2.235711</td>
    </tr>
    <tr>
      <th>Response</th>
      <td>0.149107</td>
      <td>0.149107</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.269309e-01</td>
      <td>1.269309e-01</td>
      <td>0.356274</td>
      <td>0.356274</td>
    </tr>
    <tr>
      <th>Complain</th>
      <td>0.009375</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.291257e-03</td>
      <td>0.000000e+00</td>
      <td>0.096391</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>56.194196</td>
      <td>56.089286</td>
      <td>55.0</td>
      <td>55.0</td>
      <td>49.0</td>
      <td>75.0</td>
      <td>1.436179e+02</td>
      <td>1.260715e+02</td>
      <td>11.984069</td>
      <td>11.228158</td>
    </tr>
    <tr>
      <th>TotalSpend</th>
      <td>605.798214</td>
      <td>594.263393</td>
      <td>396.0</td>
      <td>396.0</td>
      <td>46.0</td>
      <td>22.0</td>
      <td>3.627042e+05</td>
      <td>3.301940e+05</td>
      <td>602.249288</td>
      <td>574.625116</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e9ecd064-9eae-4537-b7e9-5ace3639898c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e9ecd064-9eae-4537-b7e9-5ace3639898c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e9ecd064-9eae-4537-b7e9-5ace3639898c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-09b55521-22b7-458d-a529-bb77aae3d786">
      <button class="colab-df-quickchart" onclick="quickchart('df-09b55521-22b7-458d-a529-bb77aae3d786')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-09b55521-22b7-458d-a529-bb77aae3d786 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_e9df5142-7d2f-470b-b5ca-426aa61b6449">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('combined_stats')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_e9df5142-7d2f-470b-b5ca-426aa61b6449 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('combined_stats');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<section id="task-3---probability-distributions-" class="cell markdown"
id="MXVGLPijbbSl">
<h2>Task 3 - Probability Distributions üé≤</h2>
<ul>
<li><strong>Identify variables that could follow specific probability
distributions (e.g., Binomial, Normal). Calculate probabilities and
expected values based on these distributions.</strong></li>
</ul>
</section>
<div class="cell markdown" id="E2TbHjkpbeuu">
<p><strong>Deliverables</strong>:</p>
<ul>
<li><strong>Determination of suitable probability distributions for
relevant variables and corresponding calculated probabilities and
expected values.</strong>:</li>
</ul>
</div>
<div class="cell code" data-execution_count="29"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="M74TcZD6U7ie" data-outputId="7188ff34-4536-4c5d-ee28-da5d6fc80766">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability Distributions</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> PBA_df  <span class="co"># Using your DataFrame</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Bernoulli Distribution</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;üìå Bernoulli Distribution: Binary Variables</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>binary_vars <span class="op">=</span> [<span class="st">&#39;Response&#39;</span>, <span class="st">&#39;Complain&#39;</span>]</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="bu">len</span>(binary_vars), figsize<span class="op">=</span>(<span class="dv">6</span> <span class="op">*</span> <span class="bu">len</span>(binary_vars), <span class="dv">4</span>))</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, var <span class="kw">in</span> <span class="bu">enumerate</span>(binary_vars):</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df[var].dropna()</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data.nunique() <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>        prob <span class="op">=</span> data.mean()</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>        pmf <span class="op">=</span> stats.bernoulli.pmf([<span class="dv">0</span>, <span class="dv">1</span>], prob)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>        axs[i].bar([<span class="dv">0</span>, <span class="dv">1</span>], pmf, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">&#39;steelblue&#39;</span>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>        axs[i].set_title(<span class="ss">f&#39;Bernoulli: </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>        axs[i].set_xlabel(var)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>        axs[i].set_ylabel(<span class="st">&#39;Probability&#39;</span>)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>        axs[i].set_xticks([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Normal Distribution</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;üìå Normal Distribution: Spend Variables</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>normal_vars <span class="op">=</span> [<span class="st">&#39;MntWines&#39;</span>, <span class="st">&#39;MntFruits&#39;</span>, <span class="st">&#39;MntMeatProducts&#39;</span>, <span class="st">&#39;MntFishProducts&#39;</span>, <span class="st">&#39;MntSweetProducts&#39;</span>, <span class="st">&#39;MntGoldProds&#39;</span>]</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="bu">len</span>(normal_vars), figsize<span class="op">=</span>(<span class="dv">5</span> <span class="op">*</span> <span class="bu">len</span>(normal_vars), <span class="dv">4</span>))</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, var <span class="kw">in</span> <span class="bu">enumerate</span>(normal_vars):</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df[var].dropna()</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>    mean, std <span class="op">=</span> data.mean(), data.std()</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>    sns.histplot(data, kde<span class="op">=</span><span class="va">True</span>, stat<span class="op">=</span><span class="st">&#39;density&#39;</span>, bins<span class="op">=</span><span class="dv">30</span>, ax<span class="op">=</span>axs[i], color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.linspace(data.<span class="bu">min</span>(), data.<span class="bu">max</span>(), <span class="dv">100</span>)</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>    axs[i].plot(x, stats.norm.pdf(x, mean, std), <span class="st">&#39;r&#39;</span>)</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>    axs[i].set_title(<span class="ss">f&#39;Normal: </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>    axs[i].set_xlabel(var)</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Poisson Distribution</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;üìå Poisson Distribution: Count Variables</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>poisson_vars <span class="op">=</span> [<span class="st">&#39;NumDealsPurchases&#39;</span>, <span class="st">&#39;NumWebPurchases&#39;</span>,</span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;NumCatalogPurchases&#39;</span>, <span class="st">&#39;NumStorePurchases&#39;</span>, <span class="st">&#39;NumWebVisitsMonth&#39;</span>]</span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="bu">len</span>(poisson_vars), figsize<span class="op">=</span>(<span class="dv">5</span> <span class="op">*</span> <span class="bu">len</span>(poisson_vars), <span class="dv">4</span>))</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, var <span class="kw">in</span> <span class="bu">enumerate</span>(poisson_vars):</span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df[var].dropna()</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>    lam <span class="op">=</span> data.mean()</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> np.arange(data.<span class="bu">min</span>(), data.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>    probs <span class="op">=</span> stats.poisson.pmf(values, mu<span class="op">=</span>lam)</span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>    sns.histplot(data, stat<span class="op">=</span><span class="st">&#39;probability&#39;</span>, bins<span class="op">=</span><span class="bu">len</span>(values), discrete<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&#39;lightgreen&#39;</span>, ax<span class="op">=</span>axs[i])</span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>    axs[i].plot(values, probs, <span class="st">&#39;o-&#39;</span>, color<span class="op">=</span><span class="st">&#39;red&#39;</span>, label<span class="op">=</span><span class="st">&#39;Poisson PMF&#39;</span>)</span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>    axs[i].set_title(<span class="ss">f&#39;Poisson: </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>    axs[i].set_xlabel(var)</span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>    axs[i].legend()</span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Categorical Variables</span></span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;üìå Categorical Distribution: Education and Marital Status</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a>categorical_vars <span class="op">=</span> [<span class="st">&#39;Education&#39;</span>, <span class="st">&#39;Marital_Status&#39;</span>]</span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="bu">len</span>(categorical_vars), figsize<span class="op">=</span>(<span class="dv">5</span> <span class="op">*</span> <span class="bu">len</span>(categorical_vars), <span class="dv">4</span>))</span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, var <span class="kw">in</span> <span class="bu">enumerate</span>(categorical_vars):</span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a>    counts <span class="op">=</span> df[var].value_counts()</span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a>    axs[i].bar(counts.index, counts.values, color<span class="op">=</span><span class="st">&#39;orange&#39;</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a>    axs[i].set_title(<span class="ss">f&#39;Categorical: </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a>    axs[i].set_ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>    axs[i].tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Demographic Distributions</span></span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;üìå Demographic Variables: Income, Age, Recency, Kidhome, Teenhome</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a>demographic_vars <span class="op">=</span> [<span class="st">&#39;Income&#39;</span>, <span class="st">&#39;Age&#39;</span>, <span class="st">&#39;Recency&#39;</span>, <span class="st">&#39;Kidhome&#39;</span>, <span class="st">&#39;Teenhome&#39;</span>]</span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="bu">len</span>(demographic_vars), figsize<span class="op">=</span>(<span class="dv">5</span> <span class="op">*</span> <span class="bu">len</span>(demographic_vars), <span class="dv">4</span>))</span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, var <span class="kw">in</span> <span class="bu">enumerate</span>(demographic_vars):</span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a>    sns.histplot(df[var].dropna(), bins<span class="op">=</span><span class="dv">30</span>, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&#39;purple&#39;</span>, ax<span class="op">=</span>axs[i], alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb41-94"><a href="#cb41-94" aria-hidden="true" tabindex="-1"></a>    axs[i].set_title(<span class="ss">f&#39;Distribution: </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a>    axs[i].set_xlabel(var)</span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-99"><a href="#cb41-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-100"><a href="#cb41-100" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Exponential Fit for Recency</span></span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;üìå Exponential Fit: Recency</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb41-104"><a href="#cb41-104" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb41-105"><a href="#cb41-105" aria-hidden="true" tabindex="-1"></a>recency_data <span class="op">=</span> df[<span class="st">&#39;Recency&#39;</span>].dropna()</span>
<span id="cb41-106"><a href="#cb41-106" aria-hidden="true" tabindex="-1"></a>scale <span class="op">=</span> recency_data.mean()</span>
<span id="cb41-107"><a href="#cb41-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-108"><a href="#cb41-108" aria-hidden="true" tabindex="-1"></a>sns.histplot(recency_data, stat<span class="op">=</span><span class="st">&#39;density&#39;</span>, bins<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>, ax<span class="op">=</span>ax)</span>
<span id="cb41-109"><a href="#cb41-109" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, recency_data.<span class="bu">max</span>(), <span class="dv">100</span>)</span>
<span id="cb41-110"><a href="#cb41-110" aria-hidden="true" tabindex="-1"></a>ax.plot(x, stats.expon.pdf(x, scale<span class="op">=</span>scale), <span class="st">&#39;r&#39;</span>, label<span class="op">=</span><span class="st">&#39;Exponential PDF&#39;</span>)</span>
<span id="cb41-111"><a href="#cb41-111" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Exponential Fit: Recency&#39;</span>)</span>
<span id="cb41-112"><a href="#cb41-112" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Recency&#39;</span>)</span>
<span id="cb41-113"><a href="#cb41-113" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Density&#39;</span>)</span>
<span id="cb41-114"><a href="#cb41-114" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb41-115"><a href="#cb41-115" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>üìå Bernoulli Distribution: Binary Variables

</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/2fd410e3591dce18d6a26ea9d5ed7670d6a54ff7.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>üìå Normal Distribution: Spend Variables

</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/f2b6241add587c8e95598bb291613382be452bf6.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>üìå Poisson Distribution: Count Variables

</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/d9dc7e48be8f9a3a170fb573c757484729675f83.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>üìå Categorical Distribution: Education and Marital Status

</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/fe04e36fac296d10a68184bffec5576fd6bd0951.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>üìå Demographic Variables: Income, Age, Recency, Kidhome, Teenhome

</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/f5bcc14593e834e62e65a602ceb65387088f8a1d.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>üìå Exponential Fit: Recency

</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/340063f99c6b9330f8391121bd8a0cdfb01942be.png" /></p>
</div>
</div>
<div class="cell markdown" id="LEMoY82iYO_9">
<p>###<strong>Calculate probabilities and expected values based on these
distributions.</strong></p>
</div>
<div class="cell code" data-execution_count="38"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:725}"
id="g9CyfncZvAYz" data-outputId="165458d3-c6f4-4db4-bf7e-4f3bb18a7efd">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Probabilities and expected values based on these distributions</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> PBA_df</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to append results with interpretation</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> append_result(dist, var, prob, exp_val, interpretation):</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shorten and format probability output if needed</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(prob, <span class="bu">dict</span>):</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>        prob <span class="op">=</span> {k: <span class="bu">round</span>(v, <span class="dv">3</span>) <span class="cf">for</span> k, v <span class="kw">in</span> <span class="bu">list</span>(prob.items())[:<span class="dv">5</span>]}  <span class="co"># limit to first 5 categories</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">hasattr</span>(prob, <span class="st">&#39;__iter__&#39;</span>) <span class="kw">and</span> <span class="kw">not</span> <span class="bu">isinstance</span>(prob, <span class="bu">str</span>):</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>        prob <span class="op">=</span> [<span class="bu">round</span>(p, <span class="dv">4</span>) <span class="cf">for</span> p <span class="kw">in</span> prob[:<span class="dv">5</span>]]  <span class="co"># limit and round</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    results.append({</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Distribution&#39;</span>: dist,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Variable&#39;</span>: var,</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Probability&#39;</span>: prob,</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Expected Value&#39;</span>: <span class="bu">round</span>(exp_val, <span class="dv">2</span>) <span class="cf">if</span> pd.notnull(exp_val) <span class="kw">and</span> <span class="kw">not</span> <span class="bu">isinstance</span>(exp_val, <span class="bu">str</span>) <span class="cf">else</span> exp_val,</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Interpretation&#39;</span>: interpretation</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Bernoulli</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> [<span class="st">&#39;Response&#39;</span>, <span class="st">&#39;Complain&#39;</span>]:</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df[var].dropna()</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data.nunique() <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> data.mean()</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>        append_result(<span class="st">&#39;Bernoulli&#39;</span>, var, p, p, <span class="st">&#39;Probability of event (Yes = 1)&#39;</span>)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Normal</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> [<span class="st">&#39;MntWines&#39;</span>, <span class="st">&#39;MntFruits&#39;</span>, <span class="st">&#39;MntMeatProducts&#39;</span>, <span class="st">&#39;MntFishProducts&#39;</span>, <span class="st">&#39;MntSweetProducts&#39;</span>, <span class="st">&#39;MntGoldProds&#39;</span>]:</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df[var].dropna()</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    append_result(<span class="st">&#39;Normal&#39;</span>, var, <span class="va">None</span>, data.mean(), <span class="st">&#39;Avg spend (‚Çπ/Customer)&#39;</span>)</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Poisson</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> [<span class="st">&#39;NumDealsPurchases&#39;</span>, <span class="st">&#39;NumWebPurchases&#39;</span>, <span class="st">&#39;NumCatalogPurchases&#39;</span>, <span class="st">&#39;NumStorePurchases&#39;</span>, <span class="st">&#39;NumWebVisitsMonth&#39;</span>]:</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df[var].dropna()</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>    append_result(<span class="st">&#39;Poisson&#39;</span>, var, <span class="va">None</span>, data.mean(), <span class="st">&#39;Avg count (/Customer)&#39;</span>)</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Categorical</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> [<span class="st">&#39;Education&#39;</span>, <span class="st">&#39;Marital_Status&#39;</span>]:</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>    counts <span class="op">=</span> df[var].value_counts()</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>    probs <span class="op">=</span> counts <span class="op">/</span> counts.<span class="bu">sum</span>()</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>    append_result(<span class="st">&#39;Categorical&#39;</span>, var, probs.to_dict(), <span class="st">&#39;N/A&#39;</span>, <span class="st">&#39;Probability distribution of categories&#39;</span>)</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Demographics</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> [<span class="st">&#39;Income&#39;</span>, <span class="st">&#39;Age&#39;</span>, <span class="st">&#39;Recency&#39;</span>, <span class="st">&#39;Kidhome&#39;</span>, <span class="st">&#39;Teenhome&#39;</span>]:</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df[var].dropna()</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>    probs <span class="op">=</span> stats.gaussian_kde(data)(data)</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>    interpretation <span class="op">=</span> <span class="st">&#39;Mean value (/Customer)&#39;</span> <span class="cf">if</span> var <span class="kw">not</span> <span class="kw">in</span> [<span class="st">&#39;Kidhome&#39;</span>, <span class="st">&#39;Teenhome&#39;</span>] <span class="cf">else</span> <span class="st">&#39;Avg count (/Customer)&#39;</span></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>    append_result(<span class="st">&#39;Demographic&#39;</span>, var, probs, data.mean(), interpretation)</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Exponential</span></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>recency <span class="op">=</span> df[<span class="st">&#39;Recency&#39;</span>].dropna()</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>append_result(<span class="st">&#39;Exponential&#39;</span>, <span class="st">&#39;Recency&#39;</span>, <span class="va">None</span>, recency.mean(), <span class="st">&#39;Avg recency (/Customer)&#39;</span>)</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Output clean DataFrame</span></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Use pandas display options for better formatting</span></span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&#39;display.max_rows&#39;</span>, <span class="va">None</span>)  <span class="co"># Display all rows</span></span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&#39;display.max_columns&#39;</span>, <span class="va">None</span>) <span class="co"># Display all columns</span></span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&#39;display.width&#39;</span>, <span class="va">None</span>) <span class="co"># Allow wider display</span></span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&#39;display.colheader_justify&#39;</span>, <span class="st">&#39;center&#39;</span>) <span class="co"># Center headers</span></span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&#39;display.precision&#39;</span>, <span class="dv">2</span>) <span class="co"># Set floating point precision</span></span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Probability and Expected Value Calculation Summary:&quot;</span>)</span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>display(results_df)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Probability and Expected Value Calculation Summary:
</code></pre>
</div>
<div class="output display_data">

  <div id="df-6989a1a6-e2fb-4635-9fc0-44d014f91a0d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: center;">
      <th></th>
      <th>Distribution</th>
      <th>Variable</th>
      <th>Probability</th>
      <th>Expected Value</th>
      <th>Interpretation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bernoulli</td>
      <td>Response</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>Probability of event (Yes = 1)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bernoulli</td>
      <td>Complain</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>Probability of event (Yes = 1)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Normal</td>
      <td>MntWines</td>
      <td>None</td>
      <td>303.94</td>
      <td>Avg spend (‚Çπ/Customer)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Normal</td>
      <td>MntFruits</td>
      <td>None</td>
      <td>26.3</td>
      <td>Avg spend (‚Çπ/Customer)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Normal</td>
      <td>MntMeatProducts</td>
      <td>None</td>
      <td>166.95</td>
      <td>Avg spend (‚Çπ/Customer)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Normal</td>
      <td>MntFishProducts</td>
      <td>None</td>
      <td>37.53</td>
      <td>Avg spend (‚Çπ/Customer)</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Normal</td>
      <td>MntSweetProducts</td>
      <td>None</td>
      <td>27.06</td>
      <td>Avg spend (‚Çπ/Customer)</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Normal</td>
      <td>MntGoldProds</td>
      <td>None</td>
      <td>44.02</td>
      <td>Avg spend (‚Çπ/Customer)</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Poisson</td>
      <td>NumDealsPurchases</td>
      <td>None</td>
      <td>2.33</td>
      <td>Avg count (/Customer)</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Poisson</td>
      <td>NumWebPurchases</td>
      <td>None</td>
      <td>4.08</td>
      <td>Avg count (/Customer)</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Poisson</td>
      <td>NumCatalogPurchases</td>
      <td>None</td>
      <td>2.66</td>
      <td>Avg count (/Customer)</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Poisson</td>
      <td>NumStorePurchases</td>
      <td>None</td>
      <td>5.79</td>
      <td>Avg count (/Customer)</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Poisson</td>
      <td>NumWebVisitsMonth</td>
      <td>None</td>
      <td>5.32</td>
      <td>Avg count (/Customer)</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Categorical</td>
      <td>Education</td>
      <td>{'Graduation': 0.503, 'PhD': 0.217, 'Master': 0.165, '2n Cycle': 0.091, 'Basic': 0.024}</td>
      <td>N/A</td>
      <td>Probability distribution of categories</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Categorical</td>
      <td>Marital_Status</td>
      <td>{'Married': 0.386, 'Together': 0.259, 'Single': 0.214, 'Divorced': 0.104, 'Widow': 0.034}</td>
      <td>N/A</td>
      <td>Probability distribution of categories</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Demographic</td>
      <td>Income</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0]</td>
      <td>52237.98</td>
      <td>Mean value (/Customer)</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Demographic</td>
      <td>Age</td>
      <td>[0.0312, 0.0209, 0.0215, 0.0259, 0.0107]</td>
      <td>56.19</td>
      <td>Mean value (/Customer)</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Demographic</td>
      <td>Recency</td>
      <td>[0.0057, 0.0057, 0.0057, 0.0057, 0.0057]</td>
      <td>49.11</td>
      <td>Mean value (/Customer)</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Demographic</td>
      <td>Kidhome</td>
      <td>[2.0008, 2.0008, 2.0008, 1.3911, 1.3911]</td>
      <td>0.44</td>
      <td>Avg count (/Customer)</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Demographic</td>
      <td>Teenhome</td>
      <td>[1.7717, 1.7717, 1.5759, 1.5759, 1.7717]</td>
      <td>0.51</td>
      <td>Avg count (/Customer)</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Exponential</td>
      <td>Recency</td>
      <td>None</td>
      <td>49.11</td>
      <td>Avg recency (/Customer)</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6989a1a6-e2fb-4635-9fc0-44d014f91a0d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6989a1a6-e2fb-4635-9fc0-44d014f91a0d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6989a1a6-e2fb-4635-9fc0-44d014f91a0d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-812dcad7-d62d-4ede-85bf-d36df3114fae">
      <button class="colab-df-quickchart" onclick="quickchart('df-812dcad7-d62d-4ede-85bf-d36df3114fae')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-812dcad7-d62d-4ede-85bf-d36df3114fae button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_c51ba6ac-7305-4143-8162-af287873fd09">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('results_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_c51ba6ac-7305-4143-8162-af287873fd09 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('results_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<section id="task-4-insights-and-customer-segmentation-"
class="cell markdown" id="8C55VOU1toVW">
<h2>Task 4: Insights and Customer Segmentation üìà</h2>
<ul>
<li><strong>Explore relationships between customer characteristics and
spending habits. Segment customers based on their behaviors and
characteristics.</strong></li>
</ul>
</section>
<div class="cell markdown" id="zyAcmSTatqzu">
<p><strong>Deliverables</strong>:</p>
<ul>
<li><strong>Key insights regarding relationships between variables and
distinct customer segments based on behaviors.</strong></li>
</ul>
</div>
<div class="cell code" data-execution_count="32"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="kF_bwWkWTr8c" data-outputId="c379cd3b-abde-4fea-b540-7f57396bf2c8">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># STEP 1: Correlation Heatmap</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>PBA_df_winsorized[<span class="st">&#39;Age&#39;</span>] <span class="op">=</span> <span class="dv">2025</span> <span class="op">-</span> PBA_df_winsorized[<span class="st">&#39;Year_Birth&#39;</span>]</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>numerical_features <span class="op">=</span> PBA_df_winsorized.select_dtypes(include<span class="op">=</span><span class="st">&#39;number&#39;</span>).columns</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> PBA_df_winsorized[numerical_features].corr()</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">12</span>))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation Matrix of Customer Characteristics and Spending Habits&#39;</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="co"># STEP 2: KMeans Segmentation</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="st">&#39;Income&#39;</span>, <span class="st">&#39;Age&#39;</span>, <span class="st">&#39;MntWines&#39;</span>, <span class="st">&#39;MntFruits&#39;</span>, <span class="st">&#39;MntMeatProducts&#39;</span>,</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;MntFishProducts&#39;</span>, <span class="st">&#39;MntSweetProducts&#39;</span>, <span class="st">&#39;MntGoldProds&#39;</span>,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;NumDealsPurchases&#39;</span>, <span class="st">&#39;NumWebPurchases&#39;</span>, <span class="st">&#39;NumCatalogPurchases&#39;</span>,</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;NumStorePurchases&#39;</span>, <span class="st">&#39;NumWebVisitsMonth&#39;</span>]</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>scaled_features <span class="op">=</span> scaler.fit_transform(PBA_df_winsorized[features])</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Elbow Method</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>inertia <span class="op">=</span> []</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>):</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>    kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>k, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>    kmeans.fit(scaled_features)</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>    inertia.append(kmeans.inertia_)</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>), inertia, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Elbow Method for Optimal k&#39;</span>)</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Number of Clusters (k)&#39;</span>)</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Inertia&#39;</span>)</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply KMeans with chosen k (e.g., 4)</span></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>optimal_k <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>optimal_k, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>PBA_df_winsorized[<span class="st">&#39;Cluster&#39;</span>] <span class="op">=</span> kmeans.fit_predict(scaled_features)</span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a><span class="co"># STEP 3: PCA Scatterplot</span></span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>pca_components <span class="op">=</span> pca.fit_transform(scaled_features)</span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>PBA_df_winsorized[<span class="st">&#39;PCA1&#39;</span>] <span class="op">=</span> pca_components[:, <span class="dv">0</span>]</span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>PBA_df_winsorized[<span class="st">&#39;PCA2&#39;</span>] <span class="op">=</span> pca_components[:, <span class="dv">1</span>]</span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>PBA_df_winsorized, x<span class="op">=</span><span class="st">&#39;PCA1&#39;</span>, y<span class="op">=</span><span class="st">&#39;PCA2&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Cluster&#39;</span>, palette<span class="op">=</span><span class="st">&#39;tab10&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Customer Segments Visualized with PCA&#39;</span>)</span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;PCA1&#39;</span>)</span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;PCA2&#39;</span>)</span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&#39;Cluster&#39;</span>)</span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a><span class="co"># STEP 4: Bar Plot - Cluster Means</span></span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>cluster_means <span class="op">=</span> PBA_df_winsorized.groupby(<span class="st">&#39;Cluster&#39;</span>)[features].mean().<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;üìä Average feature values per cluster:&quot;</span>)</span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a>display(cluster_means)</span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a>cluster_means.plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">8</span>))</span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Customer Segment Profiles (Numerical)&#39;</span>)</span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Cluster&#39;</span>)</span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Value&#39;</span>)</span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.2</span>, <span class="dv">1</span>))</span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-78"><a href="#cb50-78" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-79"><a href="#cb50-79" aria-hidden="true" tabindex="-1"></a><span class="co"># STEP 5: Cluster Demographics Summary</span></span>
<span id="cb50-80"><a href="#cb50-80" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-81"><a href="#cb50-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üìå Cluster Distribution by Marital Status:&quot;</span>)</span>
<span id="cb50-82"><a href="#cb50-82" aria-hidden="true" tabindex="-1"></a>display(pd.crosstab(PBA_df_winsorized[<span class="st">&#39;Cluster&#39;</span>], PBA_df_winsorized[<span class="st">&#39;Marital_Status&#39;</span>]))</span>
<span id="cb50-83"><a href="#cb50-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-84"><a href="#cb50-84" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üìå Cluster Distribution by Education:&quot;</span>)</span>
<span id="cb50-85"><a href="#cb50-85" aria-hidden="true" tabindex="-1"></a>display(pd.crosstab(PBA_df_winsorized[<span class="st">&#39;Cluster&#39;</span>], PBA_df_winsorized[<span class="st">&#39;Education&#39;</span>]))</span>
<span id="cb50-86"><a href="#cb50-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-87"><a href="#cb50-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üìå Average Kids and Teens at Home per Cluster:&quot;</span>)</span>
<span id="cb50-88"><a href="#cb50-88" aria-hidden="true" tabindex="-1"></a>display(PBA_df_winsorized.groupby(<span class="st">&#39;Cluster&#39;</span>)[[<span class="st">&#39;Kidhome&#39;</span>, <span class="st">&#39;Teenhome&#39;</span>]].mean().<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb50-89"><a href="#cb50-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-90"><a href="#cb50-90" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-91"><a href="#cb50-91" aria-hidden="true" tabindex="-1"></a><span class="co"># STEP 6: Generate Segment Summary Table</span></span>
<span id="cb50-92"><a href="#cb50-92" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb50-93"><a href="#cb50-93" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_segment_summary(df, cluster_col<span class="op">=</span><span class="st">&#39;Cluster&#39;</span>):</span>
<span id="cb50-94"><a href="#cb50-94" aria-hidden="true" tabindex="-1"></a>    summaries <span class="op">=</span> []</span>
<span id="cb50-95"><a href="#cb50-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-96"><a href="#cb50-96" aria-hidden="true" tabindex="-1"></a>    features <span class="op">=</span> [<span class="st">&#39;Income&#39;</span>, <span class="st">&#39;Age&#39;</span>, <span class="st">&#39;MntWines&#39;</span>, <span class="st">&#39;MntFruits&#39;</span>, <span class="st">&#39;MntMeatProducts&#39;</span>,</span>
<span id="cb50-97"><a href="#cb50-97" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;MntFishProducts&#39;</span>, <span class="st">&#39;MntSweetProducts&#39;</span>, <span class="st">&#39;MntGoldProds&#39;</span>,</span>
<span id="cb50-98"><a href="#cb50-98" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;NumDealsPurchases&#39;</span>, <span class="st">&#39;NumWebPurchases&#39;</span>, <span class="st">&#39;NumCatalogPurchases&#39;</span>,</span>
<span id="cb50-99"><a href="#cb50-99" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;NumStorePurchases&#39;</span>, <span class="st">&#39;NumWebVisitsMonth&#39;</span>]</span>
<span id="cb50-100"><a href="#cb50-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-101"><a href="#cb50-101" aria-hidden="true" tabindex="-1"></a>    grouped <span class="op">=</span> df.groupby(cluster_col)</span>
<span id="cb50-102"><a href="#cb50-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-103"><a href="#cb50-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cluster_id, group <span class="kw">in</span> grouped:</span>
<span id="cb50-104"><a href="#cb50-104" aria-hidden="true" tabindex="-1"></a>        avg_income <span class="op">=</span> group[<span class="st">&quot;Income&quot;</span>].mean()</span>
<span id="cb50-105"><a href="#cb50-105" aria-hidden="true" tabindex="-1"></a>        avg_age <span class="op">=</span> group[<span class="st">&quot;Age&quot;</span>].mean()</span>
<span id="cb50-106"><a href="#cb50-106" aria-hidden="true" tabindex="-1"></a>        wine <span class="op">=</span> group[<span class="st">&quot;MntWines&quot;</span>].mean()</span>
<span id="cb50-107"><a href="#cb50-107" aria-hidden="true" tabindex="-1"></a>        meat <span class="op">=</span> group[<span class="st">&quot;MntMeatProducts&quot;</span>].mean()</span>
<span id="cb50-108"><a href="#cb50-108" aria-hidden="true" tabindex="-1"></a>        gold <span class="op">=</span> group[<span class="st">&quot;MntGoldProds&quot;</span>].mean()</span>
<span id="cb50-109"><a href="#cb50-109" aria-hidden="true" tabindex="-1"></a>        sweet <span class="op">=</span> group[<span class="st">&quot;MntSweetProducts&quot;</span>].mean()</span>
<span id="cb50-110"><a href="#cb50-110" aria-hidden="true" tabindex="-1"></a>        web_purch <span class="op">=</span> group[<span class="st">&quot;NumWebPurchases&quot;</span>].mean()</span>
<span id="cb50-111"><a href="#cb50-111" aria-hidden="true" tabindex="-1"></a>        catalog_purch <span class="op">=</span> group[<span class="st">&quot;NumCatalogPurchases&quot;</span>].mean()</span>
<span id="cb50-112"><a href="#cb50-112" aria-hidden="true" tabindex="-1"></a>        store_purch <span class="op">=</span> group[<span class="st">&quot;NumStorePurchases&quot;</span>].mean()</span>
<span id="cb50-113"><a href="#cb50-113" aria-hidden="true" tabindex="-1"></a>        deals <span class="op">=</span> group[<span class="st">&quot;NumDealsPurchases&quot;</span>].mean()</span>
<span id="cb50-114"><a href="#cb50-114" aria-hidden="true" tabindex="-1"></a>        kidhome <span class="op">=</span> group[<span class="st">&quot;Kidhome&quot;</span>].mean()</span>
<span id="cb50-115"><a href="#cb50-115" aria-hidden="true" tabindex="-1"></a>        teenhome <span class="op">=</span> group[<span class="st">&quot;Teenhome&quot;</span>].mean()</span>
<span id="cb50-116"><a href="#cb50-116" aria-hidden="true" tabindex="-1"></a>        web_visits <span class="op">=</span> group[<span class="st">&quot;NumWebVisitsMonth&quot;</span>].mean()</span>
<span id="cb50-117"><a href="#cb50-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-118"><a href="#cb50-118" aria-hidden="true" tabindex="-1"></a>        marital <span class="op">=</span> group[<span class="st">&quot;Marital_Status&quot;</span>].mode()[<span class="dv">0</span>]</span>
<span id="cb50-119"><a href="#cb50-119" aria-hidden="true" tabindex="-1"></a>        education <span class="op">=</span> group[<span class="st">&quot;Education&quot;</span>].mode()[<span class="dv">0</span>]</span>
<span id="cb50-120"><a href="#cb50-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-121"><a href="#cb50-121" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Readable strings</span></span>
<span id="cb50-122"><a href="#cb50-122" aria-hidden="true" tabindex="-1"></a>        avg_income_str <span class="op">=</span> <span class="ss">f&quot;earn an average of ‚Çπ</span><span class="sc">{</span>avg_income<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss"> annually&quot;</span></span>
<span id="cb50-123"><a href="#cb50-123" aria-hidden="true" tabindex="-1"></a>        avg_age_str <span class="op">=</span> <span class="ss">f&quot;are typically </span><span class="sc">{</span>avg_age<span class="sc">:.0f}</span><span class="ss"> years old&quot;</span></span>
<span id="cb50-124"><a href="#cb50-124" aria-hidden="true" tabindex="-1"></a>        wine_str <span class="op">=</span> <span class="ss">f&quot;spend ‚Çπ</span><span class="sc">{</span>wine<span class="sc">:.0f}</span><span class="ss"> on wine&quot;</span></span>
<span id="cb50-125"><a href="#cb50-125" aria-hidden="true" tabindex="-1"></a>        meat_str <span class="op">=</span> <span class="ss">f&quot;spend ‚Çπ</span><span class="sc">{</span>meat<span class="sc">:.0f}</span><span class="ss"> on meat products&quot;</span></span>
<span id="cb50-126"><a href="#cb50-126" aria-hidden="true" tabindex="-1"></a>        gold_str <span class="op">=</span> <span class="ss">f&quot;spend ‚Çπ</span><span class="sc">{</span>gold<span class="sc">:.0f}</span><span class="ss"> on gold&quot;</span></span>
<span id="cb50-127"><a href="#cb50-127" aria-hidden="true" tabindex="-1"></a>        sweet_str <span class="op">=</span> <span class="ss">f&quot;spend ‚Çπ</span><span class="sc">{</span>sweet<span class="sc">:.0f}</span><span class="ss"> on sweets&quot;</span></span>
<span id="cb50-128"><a href="#cb50-128" aria-hidden="true" tabindex="-1"></a>        web_purch_str <span class="op">=</span> <span class="ss">f&quot;make about </span><span class="sc">{</span>web_purch<span class="sc">:.1f}</span><span class="ss"> web purchases/year&quot;</span></span>
<span id="cb50-129"><a href="#cb50-129" aria-hidden="true" tabindex="-1"></a>        catalog_purch_str <span class="op">=</span> <span class="ss">f&quot;make about </span><span class="sc">{</span>catalog_purch<span class="sc">:.1f}</span><span class="ss"> catalog purchases/year&quot;</span></span>
<span id="cb50-130"><a href="#cb50-130" aria-hidden="true" tabindex="-1"></a>        store_purch_str <span class="op">=</span> <span class="ss">f&quot;make about </span><span class="sc">{</span>store_purch<span class="sc">:.1f}</span><span class="ss"> store purchases/year&quot;</span></span>
<span id="cb50-131"><a href="#cb50-131" aria-hidden="true" tabindex="-1"></a>        deals_str <span class="op">=</span> <span class="ss">f&quot;take advantage of deals ~</span><span class="sc">{</span>deals<span class="sc">:.1f}</span><span class="ss"> times/year&quot;</span></span>
<span id="cb50-132"><a href="#cb50-132" aria-hidden="true" tabindex="-1"></a>        web_visits_str <span class="op">=</span> <span class="ss">f&quot;visit websites ~</span><span class="sc">{</span>web_visits<span class="sc">:.1f}</span><span class="ss"> times/month&quot;</span></span>
<span id="cb50-133"><a href="#cb50-133" aria-hidden="true" tabindex="-1"></a>        kidhome_str <span class="op">=</span> <span class="ss">f&quot;have around </span><span class="sc">{</span>kidhome<span class="sc">:.1f}</span><span class="ss"> child</span><span class="sc">{</span><span class="st">&#39;ren&#39;</span> <span class="cf">if</span> kidhome <span class="op">!=</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">&#39;&#39;</span><span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb50-134"><a href="#cb50-134" aria-hidden="true" tabindex="-1"></a>        teenhome_str <span class="op">=</span> <span class="ss">f&quot;have around </span><span class="sc">{</span>teenhome<span class="sc">:.1f}</span><span class="ss"> teen</span><span class="sc">{</span><span class="st">&#39;s&#39;</span> <span class="cf">if</span> teenhome <span class="op">!=</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">&#39;&#39;</span><span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb50-135"><a href="#cb50-135" aria-hidden="true" tabindex="-1"></a>        marital_str <span class="op">=</span> <span class="ss">f&quot;are mostly </span><span class="sc">{</span>marital<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb50-136"><a href="#cb50-136" aria-hidden="true" tabindex="-1"></a>        education_str <span class="op">=</span> <span class="ss">f&quot;and most have a </span><span class="sc">{</span>education<span class="sc">}</span><span class="ss"> education.&quot;</span></span>
<span id="cb50-137"><a href="#cb50-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-138"><a href="#cb50-138" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Interpret</span></span>
<span id="cb50-139"><a href="#cb50-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> avg_income <span class="op">&gt;</span> <span class="dv">70000</span> <span class="kw">and</span> (wine <span class="op">+</span> gold <span class="op">&gt;</span> <span class="dv">800</span>):</span>
<span id="cb50-140"><a href="#cb50-140" aria-hidden="true" tabindex="-1"></a>            tag <span class="op">=</span> <span class="st">&quot;High-income, luxury-seeking group ‚Äì target with premium offers.&quot;</span></span>
<span id="cb50-141"><a href="#cb50-141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> kidhome <span class="op">+</span> teenhome <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb50-142"><a href="#cb50-142" aria-hidden="true" tabindex="-1"></a>            tag <span class="op">=</span> <span class="st">&quot;Family-focused group ‚Äì good for bundled deals and discounts.&quot;</span></span>
<span id="cb50-143"><a href="#cb50-143" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> web_purch <span class="op">+</span> catalog_purch <span class="op">&gt;</span> store_purch:</span>
<span id="cb50-144"><a href="#cb50-144" aria-hidden="true" tabindex="-1"></a>            tag <span class="op">=</span> <span class="st">&quot;Digitally active ‚Äì prioritize online and email marketing.&quot;</span></span>
<span id="cb50-145"><a href="#cb50-145" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> avg_age <span class="op">&gt;</span> <span class="dv">60</span> <span class="kw">and</span> avg_income <span class="op">&lt;</span> <span class="dv">40000</span>:</span>
<span id="cb50-146"><a href="#cb50-146" aria-hidden="true" tabindex="-1"></a>            tag <span class="op">=</span> <span class="st">&quot;Older low-income segment ‚Äì may need outreach for engagement.&quot;</span></span>
<span id="cb50-147"><a href="#cb50-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb50-148"><a href="#cb50-148" aria-hidden="true" tabindex="-1"></a>            tag <span class="op">=</span> <span class="st">&quot;Balanced behavior group ‚Äì general promotions may work well.&quot;</span></span>
<span id="cb50-149"><a href="#cb50-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-150"><a href="#cb50-150" aria-hidden="true" tabindex="-1"></a>        summary <span class="op">=</span> (<span class="ss">f&quot;Customers in this segment </span><span class="sc">{</span>avg_income_str<span class="sc">}</span><span class="ss"> and </span><span class="sc">{</span>avg_age_str<span class="sc">}</span><span class="ss">. &quot;</span></span>
<span id="cb50-151"><a href="#cb50-151" aria-hidden="true" tabindex="-1"></a>                   <span class="ss">f&quot;They typically </span><span class="sc">{</span>wine_str<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>gold_str<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>meat_str<span class="sc">}</span><span class="ss">, and </span><span class="sc">{</span>sweet_str<span class="sc">}</span><span class="ss">. &quot;</span></span>
<span id="cb50-152"><a href="#cb50-152" aria-hidden="true" tabindex="-1"></a>                   <span class="ss">f&quot;They </span><span class="sc">{</span>web_purch_str<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>catalog_purch_str<span class="sc">}</span><span class="ss">, and </span><span class="sc">{</span>store_purch_str<span class="sc">}</span><span class="ss">. &quot;</span></span>
<span id="cb50-153"><a href="#cb50-153" aria-hidden="true" tabindex="-1"></a>                   <span class="ss">f&quot;They </span><span class="sc">{</span>deals_str<span class="sc">}</span><span class="ss"> and </span><span class="sc">{</span>web_visits_str<span class="sc">}</span><span class="ss">. &quot;</span></span>
<span id="cb50-154"><a href="#cb50-154" aria-hidden="true" tabindex="-1"></a>                   <span class="ss">f&quot;On the family side, they </span><span class="sc">{</span>kidhome_str<span class="sc">}</span><span class="ss"> and </span><span class="sc">{</span>teenhome_str<span class="sc">}</span><span class="ss">. &quot;</span></span>
<span id="cb50-155"><a href="#cb50-155" aria-hidden="true" tabindex="-1"></a>                   <span class="ss">f&quot;The majority </span><span class="sc">{</span>marital_str<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>education_str<span class="sc">}</span><span class="ss"> ‚û§ </span><span class="sc">{</span>tag<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb50-156"><a href="#cb50-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-157"><a href="#cb50-157" aria-hidden="true" tabindex="-1"></a>        summaries.append({</span>
<span id="cb50-158"><a href="#cb50-158" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Cluster&quot;</span>: cluster_id,</span>
<span id="cb50-159"><a href="#cb50-159" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Segment Summary&quot;</span>: summary</span>
<span id="cb50-160"><a href="#cb50-160" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb50-161"><a href="#cb50-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-162"><a href="#cb50-162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(summaries)</span>
<span id="cb50-163"><a href="#cb50-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-164"><a href="#cb50-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate and show table</span></span>
<span id="cb50-165"><a href="#cb50-165" aria-hidden="true" tabindex="-1"></a>segment_table <span class="op">=</span> generate_segment_summary(PBA_df_winsorized)</span>
<span id="cb50-166"><a href="#cb50-166" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&#39;display.max_colwidth&#39;</span>, <span class="va">None</span>)</span>
<span id="cb50-167"><a href="#cb50-167" aria-hidden="true" tabindex="-1"></a>display(HTML(segment_table.to_html(index<span class="op">=</span><span class="va">False</span>)))</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/8f4b2f1fb3e276b77e6cbde5e233ca71439707df.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/615097979238c26a5f91373e991e1f81e9bcdcdb.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/d6bc62ff9ef278c91f9a019f3a91775e726ae008.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>üìä Average feature values per cluster:
</code></pre>
</div>
<div class="output display_data">

  <div id="df-f403a776-c16a-4be9-b19c-8244cad679ae" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Income</th>
      <th>Age</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
    </tr>
    <tr>
      <th>Cluster</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>35008.4</td>
      <td>53.7</td>
      <td>36.0</td>
      <td>4.6</td>
      <td>21.5</td>
      <td>6.8</td>
      <td>4.8</td>
      <td>14.2</td>
      <td>1.9</td>
      <td>2.0</td>
      <td>0.5</td>
      <td>3.2</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>68079.1</td>
      <td>59.0</td>
      <td>572.6</td>
      <td>32.3</td>
      <td>244.3</td>
      <td>48.4</td>
      <td>35.3</td>
      <td>57.2</td>
      <td>2.0</td>
      <td>5.7</td>
      <td>4.5</td>
      <td>8.7</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50906.0</td>
      <td>59.4</td>
      <td>357.5</td>
      <td>12.6</td>
      <td>95.4</td>
      <td>18.6</td>
      <td>13.1</td>
      <td>54.6</td>
      <td>4.4</td>
      <td>6.0</td>
      <td>2.2</td>
      <td>6.4</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>75146.6</td>
      <td>56.0</td>
      <td>557.6</td>
      <td>77.8</td>
      <td>462.7</td>
      <td>109.0</td>
      <td>77.2</td>
      <td>82.0</td>
      <td>1.3</td>
      <td>5.1</td>
      <td>5.8</td>
      <td>8.3</td>
      <td>2.7</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f403a776-c16a-4be9-b19c-8244cad679ae')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f403a776-c16a-4be9-b19c-8244cad679ae button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f403a776-c16a-4be9-b19c-8244cad679ae');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-2dec72f2-5f72-452a-8c06-95ce0a762d73">
      <button class="colab-df-quickchart" onclick="quickchart('df-2dec72f2-5f72-452a-8c06-95ce0a762d73')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-2dec72f2-5f72-452a-8c06-95ce0a762d73 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_1804981c-cb73-4cfb-925c-e6a10ae5d2d4">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('cluster_means')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_1804981c-cb73-4cfb-925c-e6a10ae5d2d4 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('cluster_means');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/db912ae8d4a19b2c09de714d72e2894e3ad0b2a2.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>
üìå Cluster Distribution by Marital Status:
</code></pre>
</div>
<div class="output display_data">

  <div id="df-5098ea16-b265-4370-bb0d-318e9477742d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Marital_Status</th>
      <th>Absurd</th>
      <th>Alone</th>
      <th>Divorced</th>
      <th>Married</th>
      <th>Single</th>
      <th>Together</th>
      <th>Widow</th>
      <th>YOLO</th>
    </tr>
    <tr>
      <th>Cluster</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2</td>
      <td>96</td>
      <td>389</td>
      <td>223</td>
      <td>257</td>
      <td>24</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>53</td>
      <td>183</td>
      <td>90</td>
      <td>121</td>
      <td>15</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>44</td>
      <td>149</td>
      <td>71</td>
      <td>102</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>0</td>
      <td>39</td>
      <td>143</td>
      <td>96</td>
      <td>100</td>
      <td>20</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5098ea16-b265-4370-bb0d-318e9477742d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5098ea16-b265-4370-bb0d-318e9477742d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5098ea16-b265-4370-bb0d-318e9477742d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-4662d313-6e1c-48f8-9726-9391d072190b">
      <button class="colab-df-quickchart" onclick="quickchart('df-4662d313-6e1c-48f8-9726-9391d072190b')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-4662d313-6e1c-48f8-9726-9391d072190b button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
<div class="output stream stdout">
<pre><code>
üìå Cluster Distribution by Education:
</code></pre>
</div>
<div class="output display_data">

  <div id="df-939ae52f-6f9e-41c2-b3e9-86a5deec5f3a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Education</th>
      <th>2n Cycle</th>
      <th>Basic</th>
      <th>Graduation</th>
      <th>Master</th>
      <th>PhD</th>
    </tr>
    <tr>
      <th>Cluster</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>108</td>
      <td>52</td>
      <td>483</td>
      <td>163</td>
      <td>185</td>
    </tr>
    <tr>
      <th>1</th>
      <td>32</td>
      <td>0</td>
      <td>208</td>
      <td>80</td>
      <td>142</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24</td>
      <td>2</td>
      <td>187</td>
      <td>75</td>
      <td>99</td>
    </tr>
    <tr>
      <th>3</th>
      <td>39</td>
      <td>0</td>
      <td>249</td>
      <td>52</td>
      <td>60</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-939ae52f-6f9e-41c2-b3e9-86a5deec5f3a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-939ae52f-6f9e-41c2-b3e9-86a5deec5f3a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-939ae52f-6f9e-41c2-b3e9-86a5deec5f3a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-a0897eb4-f208-4c3b-b911-dc3e7ce6e8e9">
      <button class="colab-df-quickchart" onclick="quickchart('df-a0897eb4-f208-4c3b-b911-dc3e7ce6e8e9')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-a0897eb4-f208-4c3b-b911-dc3e7ce6e8e9 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
<div class="output stream stdout">
<pre><code>
üìå Average Kids and Teens at Home per Cluster:
</code></pre>
</div>
<div class="output display_data">

  <div id="df-a878589e-8adf-41ec-9880-941367bfe752" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Kidhome</th>
      <th>Teenhome</th>
    </tr>
    <tr>
      <th>Cluster</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.76</td>
      <td>0.45</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.11</td>
      <td>0.57</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.47</td>
      <td>0.90</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.02</td>
      <td>0.20</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a878589e-8adf-41ec-9880-941367bfe752')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a878589e-8adf-41ec-9880-941367bfe752 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a878589e-8adf-41ec-9880-941367bfe752');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-2920d86f-3562-4a51-b3c9-a13688b4a40b">
      <button class="colab-df-quickchart" onclick="quickchart('df-2920d86f-3562-4a51-b3c9-a13688b4a40b')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-2920d86f-3562-4a51-b3c9-a13688b4a40b button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
<div class="output display_data">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Cluster</th>
      <th>Segment Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Customers in this segment earn an average of ‚Çπ35,008 annually and are typically 54 years old. They typically spend ‚Çπ36 on wine, spend ‚Çπ14 on gold, spend ‚Çπ22 on meat products, and spend ‚Çπ5 on sweets. They make about 2.0 web purchases/year, make about 0.5 catalog purchases/year, and make about 3.2 store purchases/year. They take advantage of deals ~1.9 times/year and visit websites ~6.2 times/month. On the family side, they have around 0.8 children and have around 0.4 teens. The majority are mostly Married and most have a Graduation education. ‚û§ Family-focused group ‚Äì good for bundled deals and discounts.</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Customers in this segment earn an average of ‚Çπ68,079 annually and are typically 59 years old. They typically spend ‚Çπ573 on wine, spend ‚Çπ57 on gold, spend ‚Çπ244 on meat products, and spend ‚Çπ35 on sweets. They make about 5.7 web purchases/year, make about 4.5 catalog purchases/year, and make about 8.7 store purchases/year. They take advantage of deals ~2.0 times/year and visit websites ~4.1 times/month. On the family side, they have around 0.1 children and have around 0.6 teens. The majority are mostly Married and most have a Graduation education. ‚û§ Digitally active ‚Äì prioritize online and email marketing.</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Customers in this segment earn an average of ‚Çπ50,906 annually and are typically 59 years old. They typically spend ‚Çπ358 on wine, spend ‚Çπ55 on gold, spend ‚Çπ95 on meat products, and spend ‚Çπ13 on sweets. They make about 6.0 web purchases/year, make about 2.2 catalog purchases/year, and make about 6.4 store purchases/year. They take advantage of deals ~4.4 times/year and visit websites ~6.8 times/month. On the family side, they have around 0.5 children and have around 0.9 teens. The majority are mostly Married and most have a Graduation education. ‚û§ Family-focused group ‚Äì good for bundled deals and discounts.</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Customers in this segment earn an average of ‚Çπ75,147 annually and are typically 56 years old. They typically spend ‚Çπ558 on wine, spend ‚Çπ82 on gold, spend ‚Çπ463 on meat products, and spend ‚Çπ77 on sweets. They make about 5.1 web purchases/year, make about 5.8 catalog purchases/year, and make about 8.3 store purchases/year. They take advantage of deals ~1.3 times/year and visit websites ~2.7 times/month. On the family side, they have around 0.0 children and have around 0.2 teens. The majority are mostly Married and most have a Graduation education. ‚û§ Digitally active ‚Äì prioritize online and email marketing.</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<section id="task-5-conclusion-and-recommendations"
class="cell markdown" id="n-dosU9ABOPx">
<h2>Task 5: Conclusion and Recommendations</h2>
<ul>
<li><strong>Create clear visualizations to showcase your findings. Use
insights to make recommendations for the company based on your
analysis.</strong></li>
</ul>
</section>
<div class="cell markdown" id="Kd55lvYEBT0A">
<p><strong>Deliverables</strong>:</p>
<ul>
<li><strong>Well-designed visualizations that visually represent your
insights and actionable recommendations based on customer behavior
analysis.</strong></li>
</ul>
</div>
<div class="cell code" data-execution_count="33"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="lml8roBVj4ta" data-outputId="660f5f80-edae-4707-82c1-b78b34319068">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Recomenadtion Based on Customer Behavior Analysis</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Spending by Cluster (Bar Plot)</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Cluster&#39;</span>, y<span class="op">=</span><span class="st">&#39;TotalSpend&#39;</span>, data<span class="op">=</span>PBA_df_winsorized, palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Average Total Spending by Customer Cluster&#39;</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Cluster&#39;</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Total Spend (‚Çπ)&#39;</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Response Rate by Cluster (Bar Plot)</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Cluster&#39;</span>, y<span class="op">=</span><span class="st">&#39;Response&#39;</span>, data<span class="op">=</span>PBA_df_winsorized, palette<span class="op">=</span><span class="st">&#39;magma&#39;</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Offer Acceptance Rate by Customer Cluster&#39;</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Cluster&#39;</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Offer Acceptance Rate (Probability)&#39;</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Key Spending Categories by Cluster</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>spending_cols <span class="op">=</span> [<span class="st">&#39;MntWines&#39;</span>, <span class="st">&#39;MntMeatProducts&#39;</span>, <span class="st">&#39;MntFruits&#39;</span>, <span class="st">&#39;MntSweetProducts&#39;</span>, <span class="st">&#39;MntGoldProds&#39;</span>]</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>cluster_spending <span class="op">=</span> PBA_df_winsorized.groupby(<span class="st">&#39;Cluster&#39;</span>)[spending_cols].mean().reset_index()</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>))</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>cluster_spending.set_index(<span class="st">&#39;Cluster&#39;</span>).T.plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>), cmap<span class="op">=</span><span class="st">&#39;tab10&#39;</span>)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Average Spending on Different Product Categories by Cluster&#39;</span>)</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Product Category&#39;</span>)</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Spend (‚Çπ)&#39;</span>)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&#39;Cluster&#39;</span>)</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Customer Demographics by Cluster</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>demographic_cols <span class="op">=</span> [<span class="st">&#39;Age&#39;</span>, <span class="st">&#39;Income&#39;</span>, <span class="st">&#39;Kidhome&#39;</span>, <span class="st">&#39;Teenhome&#39;</span>, <span class="st">&#39;Recency&#39;</span>]</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>cluster_demographics <span class="op">=</span> PBA_df_winsorized.groupby(<span class="st">&#39;Cluster&#39;</span>)[demographic_cols].mean().reset_index()</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>))</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>cluster_demographics.set_index(<span class="st">&#39;Cluster&#39;</span>).T.plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>), cmap<span class="op">=</span><span class="st">&#39;plasma&#39;</span>)</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Average Demographic Characteristics by Cluster&#39;</span>)</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Characteristic&#39;</span>)</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Value&#39;</span>)</span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&#39;Cluster&#39;</span>)</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Actionable Recommendations based on Cluster Analysis ---</span></span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">--- Actionable Recommendations ---&quot;</span>)</span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Get segment summaries (assuming the function from Task 4 is available)</span></span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>segment_table <span class="op">=</span> generate_segment_summary(PBA_df_winsorized)</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through the clusters and provide tailored recommendations</span></span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> segment_table.iterrows():</span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>    cluster_id <span class="op">=</span> row[<span class="st">&#39;Cluster&#39;</span>]</span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>    summary <span class="op">=</span> row[<span class="st">&#39;Segment Summary&#39;</span>]</span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üîë Recommendations for Cluster </span><span class="sc">{</span>cluster_id<span class="sc">}</span><span class="ss">:&quot;</span>)</span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Cluster Profile: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot;</span>) <span class="co"># Displaying the detailed profile from Task 4</span></span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add specific recommendations based on the insights (referencing visualizations and profiles)</span></span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&#39;High-income, luxury-seeking group&#39;</span> <span class="kw">in</span> summary:</span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Strategy: Target with exclusive offers on premium products (Wines, Meat, Gold). Highlight product quality and luxury.&quot;</span>)</span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Channel: Focus on personalized email campaigns and potentially direct mail for high-value customers.&quot;</span>)</span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Offer Type: Consider loyalty programs, early access to new high-end products, and VIP events.&quot;</span>)</span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-70"><a href="#cb55-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">&#39;Family-focused group&#39;</span> <span class="kw">in</span> summary:</span>
<span id="cb55-71"><a href="#cb55-71" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Strategy: Offer bundled deals on family-friendly products (Fruits, Sweets, basic groceries if available). Emphasize value and convenience.&quot;</span>)</span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Channel: Digital channels (web, app) for easy browsing and purchasing, social media campaigns featuring family life.&quot;</span>)</span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Offer Type: Family discounts, coupons for everyday items, &#39;buy one get one&#39; on frequently purchased items.&quot;</span>)</span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">&#39;Digitally active&#39;</span> <span class="kw">in</span> summary:</span>
<span id="cb55-76"><a href="#cb55-76" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Strategy: Optimize the website and mobile app experience. Ensure smooth online purchase process.&quot;</span>)</span>
<span id="cb55-77"><a href="#cb55-77" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Channel: Digital marketing is key: SEO, SEM, targeted online ads, email marketing, social media engagement.&quot;</span>)</span>
<span id="cb55-78"><a href="#cb55-78" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Offer Type: Web-exclusive discounts, free shipping promotions for online orders, personalized online recommendations.&quot;</span>)</span>
<span id="cb55-79"><a href="#cb55-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-80"><a href="#cb55-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">&#39;Older low-income segment&#39;</span> <span class="kw">in</span> summary:</span>
<span id="cb55-81"><a href="#cb55-81" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Strategy: Focus on affordability and value for money. Offer deals on essential items.&quot;</span>)</span>
<span id="cb55-82"><a href="#cb55-82" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Channel: Consider traditional channels like print media or direct mail if they are less digitally active. Ensure clear and easy-to-understand communications.&quot;</span>)</span>
<span id="cb55-83"><a href="#cb55-83" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Offer Type: Loyalty cards with points that convert to discounts, special discounts for seniors, clear and simple promotions.&quot;</span>)</span>
<span id="cb55-84"><a href="#cb55-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-85"><a href="#cb55-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">&#39;Balanced behavior group&#39;</span> <span class="kw">in</span> summary:</span>
<span id="cb55-86"><a href="#cb55-86" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Strategy: Continue with general marketing efforts but test different channels and offer types to see what resonates best within this diverse group.&quot;</span>)</span>
<span id="cb55-87"><a href="#cb55-87" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Channel: Utilize a mix of online and offline channels. Monitor performance closely.&quot;</span>)</span>
<span id="cb55-88"><a href="#cb55-88" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  - Offer Type: A variety of promotions ‚Äì percentage discounts, fixed amount off, free gifts ‚Äì tailored as data allows.&quot;</span>)</span>
<span id="cb55-89"><a href="#cb55-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb55-90"><a href="#cb55-90" aria-hidden="true" tabindex="-1"></a>         <span class="bu">print</span>(<span class="st">&quot;  - Strategy: General marketing efforts, monitor behavior for future refinement.&quot;</span>)</span>
<span id="cb55-91"><a href="#cb55-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-92"><a href="#cb55-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-93"><a href="#cb55-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># General recommendation applicable to most clusters:</span></span>
<span id="cb55-94"><a href="#cb55-94" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;  - General: Analyze Recency for targeted re-engagement campaigns for customers who haven&#39;t purchased recently.&quot;</span>)</span>
<span id="cb55-95"><a href="#cb55-95" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;  - General: Use insights on &#39;NumWebVisitsMonth&#39; and purchase channels to tailor the customer journey across different platforms.&quot;</span>)</span>
<span id="cb55-96"><a href="#cb55-96" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;-&quot;</span> <span class="op">*</span> <span class="dv">30</span>)</span>
<span id="cb55-97"><a href="#cb55-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-98"><a href="#cb55-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-99"><a href="#cb55-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Final Summary and Overall Recommendations</span></span>
<span id="cb55-100"><a href="#cb55-100" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">--- Overall Conclusions and Strategic Recommendations ---&quot;</span>)</span>
<span id="cb55-101"><a href="#cb55-101" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The analysis revealed distinct customer segments with varying demographics, spending habits, and potential for offer acceptance.&quot;</span>)</span>
<span id="cb55-102"><a href="#cb55-102" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Tailoring marketing strategies based on these segments is crucial for optimizing campaign effectiveness.&quot;</span>)</span>
<span id="cb55-103"><a href="#cb55-103" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Key Takeaways:&quot;</span>)</span>
<span id="cb55-104"><a href="#cb55-104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;- High-income segments respond well to premium offers and likely have higher average transaction values.&quot;</span>)</span>
<span id="cb55-105"><a href="#cb55-105" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;- Family segments may be price-sensitive and value convenience and deals on everyday goods.&quot;</span>)</span>
<span id="cb55-106"><a href="#cb55-106" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;- Digitally active segments require a strong online presence and targeted digital campaigns.&quot;</span>)</span>
<span id="cb55-107"><a href="#cb55-107" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;- Understanding the preferred purchase channels (web, store, catalog) for each segment is vital for channel allocation.&quot;</span>)</span>
<span id="cb55-108"><a href="#cb55-108" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;- Recency analysis is important for identifying churn risk and implementing re-engagement strategies.&quot;</span>)</span>
<span id="cb55-109"><a href="#cb55-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-110"><a href="#cb55-110" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Strategic Recommendations:&quot;</span>)</span>
<span id="cb55-111"><a href="#cb55-111" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;1. Implement targeted marketing campaigns for each identified customer segment, customizing product recommendations, offer types, and communication channels.&quot;</span>)</span>
<span id="cb55-112"><a href="#cb55-112" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;2. Allocate marketing budget based on the potential return of each segment. Invest more in segments with higher average spend or higher offer acceptance rates.&quot;</span>)</span>
<span id="cb55-113"><a href="#cb55-113" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;3. Develop loyalty programs or tiered benefits that cater to the specific spending patterns and preferences of different clusters.&quot;</span>)</span>
<span id="cb55-114"><a href="#cb55-114" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;4. Continuously monitor customer behavior and segment performance to refine segmentation and marketing strategies over time.&quot;</span>)</span>
<span id="cb55-115"><a href="#cb55-115" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;5. For segments with lower engagement or response rates, consider A/B testing different approaches to identify effective strategies.&quot;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-33-3f30ad31d22a&gt;:4: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.barplot(x=&#39;Cluster&#39;, y=&#39;TotalSpend&#39;, data=PBA_df_winsorized, palette=&#39;viridis&#39;)
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/a518605ccf3d6d9069c7924fae68abb4ec6e0be4.png" /></p>
</div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-33-3f30ad31d22a&gt;:12: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.barplot(x=&#39;Cluster&#39;, y=&#39;Response&#39;, data=PBA_df_winsorized, palette=&#39;magma&#39;)
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/25fcecf75d98645d4bf7cc1547cf1ac782f71879.png" /></p>
</div>
<div class="output display_data">
<pre><code>&lt;Figure size 1200x700 with 0 Axes&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/0bdf0785b4e916ff4a7b58fb99f53316cfef3e23.png" /></p>
</div>
<div class="output display_data">
<pre><code>&lt;Figure size 1200x700 with 0 Axes&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bd59ad6c11ad47cca940e6a5d6ed383c/2698570705445ea190b552fa1f00ad7590df7e38.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>
--- Actionable Recommendations ---

üîë Recommendations for Cluster 0:
Cluster Profile: Customers in this segment earn an average of ‚Çπ35,008 annually and are typically 54 years old. They typically spend ‚Çπ36 on wine, spend ‚Çπ14 on gold, spend ‚Çπ22 on meat products, and spend ‚Çπ5 on sweets. They make about 2.0 web purchases/year, make about 0.5 catalog purchases/year, and make about 3.2 store purchases/year. They take advantage of deals ~1.9 times/year and visit websites ~6.2 times/month. On the family side, they have around 0.8 children and have around 0.4 teens. The majority are mostly Married and most have a Graduation education. ‚û§ Family-focused group ‚Äì good for bundled deals and discounts.
  - Strategy: Offer bundled deals on family-friendly products (Fruits, Sweets, basic groceries if available). Emphasize value and convenience.
  - Channel: Digital channels (web, app) for easy browsing and purchasing, social media campaigns featuring family life.
  - Offer Type: Family discounts, coupons for everyday items, &#39;buy one get one&#39; on frequently purchased items.
  - General: Analyze Recency for targeted re-engagement campaigns for customers who haven&#39;t purchased recently.
  - General: Use insights on &#39;NumWebVisitsMonth&#39; and purchase channels to tailor the customer journey across different platforms.
------------------------------

üîë Recommendations for Cluster 1:
Cluster Profile: Customers in this segment earn an average of ‚Çπ68,079 annually and are typically 59 years old. They typically spend ‚Çπ573 on wine, spend ‚Çπ57 on gold, spend ‚Çπ244 on meat products, and spend ‚Çπ35 on sweets. They make about 5.7 web purchases/year, make about 4.5 catalog purchases/year, and make about 8.7 store purchases/year. They take advantage of deals ~2.0 times/year and visit websites ~4.1 times/month. On the family side, they have around 0.1 children and have around 0.6 teens. The majority are mostly Married and most have a Graduation education. ‚û§ Digitally active ‚Äì prioritize online and email marketing.
  - Strategy: Optimize the website and mobile app experience. Ensure smooth online purchase process.
  - Channel: Digital marketing is key: SEO, SEM, targeted online ads, email marketing, social media engagement.
  - Offer Type: Web-exclusive discounts, free shipping promotions for online orders, personalized online recommendations.
  - General: Analyze Recency for targeted re-engagement campaigns for customers who haven&#39;t purchased recently.
  - General: Use insights on &#39;NumWebVisitsMonth&#39; and purchase channels to tailor the customer journey across different platforms.
------------------------------

üîë Recommendations for Cluster 2:
Cluster Profile: Customers in this segment earn an average of ‚Çπ50,906 annually and are typically 59 years old. They typically spend ‚Çπ358 on wine, spend ‚Çπ55 on gold, spend ‚Çπ95 on meat products, and spend ‚Çπ13 on sweets. They make about 6.0 web purchases/year, make about 2.2 catalog purchases/year, and make about 6.4 store purchases/year. They take advantage of deals ~4.4 times/year and visit websites ~6.8 times/month. On the family side, they have around 0.5 children and have around 0.9 teens. The majority are mostly Married and most have a Graduation education. ‚û§ Family-focused group ‚Äì good for bundled deals and discounts.
  - Strategy: Offer bundled deals on family-friendly products (Fruits, Sweets, basic groceries if available). Emphasize value and convenience.
  - Channel: Digital channels (web, app) for easy browsing and purchasing, social media campaigns featuring family life.
  - Offer Type: Family discounts, coupons for everyday items, &#39;buy one get one&#39; on frequently purchased items.
  - General: Analyze Recency for targeted re-engagement campaigns for customers who haven&#39;t purchased recently.
  - General: Use insights on &#39;NumWebVisitsMonth&#39; and purchase channels to tailor the customer journey across different platforms.
------------------------------

üîë Recommendations for Cluster 3:
Cluster Profile: Customers in this segment earn an average of ‚Çπ75,147 annually and are typically 56 years old. They typically spend ‚Çπ558 on wine, spend ‚Çπ82 on gold, spend ‚Çπ463 on meat products, and spend ‚Çπ77 on sweets. They make about 5.1 web purchases/year, make about 5.8 catalog purchases/year, and make about 8.3 store purchases/year. They take advantage of deals ~1.3 times/year and visit websites ~2.7 times/month. On the family side, they have around 0.0 children and have around 0.2 teens. The majority are mostly Married and most have a Graduation education. ‚û§ Digitally active ‚Äì prioritize online and email marketing.
  - Strategy: Optimize the website and mobile app experience. Ensure smooth online purchase process.
  - Channel: Digital marketing is key: SEO, SEM, targeted online ads, email marketing, social media engagement.
  - Offer Type: Web-exclusive discounts, free shipping promotions for online orders, personalized online recommendations.
  - General: Analyze Recency for targeted re-engagement campaigns for customers who haven&#39;t purchased recently.
  - General: Use insights on &#39;NumWebVisitsMonth&#39; and purchase channels to tailor the customer journey across different platforms.
------------------------------

--- Overall Conclusions and Strategic Recommendations ---
The analysis revealed distinct customer segments with varying demographics, spending habits, and potential for offer acceptance.
Tailoring marketing strategies based on these segments is crucial for optimizing campaign effectiveness.

Key Takeaways:
- High-income segments respond well to premium offers and likely have higher average transaction values.
- Family segments may be price-sensitive and value convenience and deals on everyday goods.
- Digitally active segments require a strong online presence and targeted digital campaigns.
- Understanding the preferred purchase channels (web, store, catalog) for each segment is vital for channel allocation.
- Recency analysis is important for identifying churn risk and implementing re-engagement strategies.

Strategic Recommendations:
1. Implement targeted marketing campaigns for each identified customer segment, customizing product recommendations, offer types, and communication channels.
2. Allocate marketing budget based on the potential return of each segment. Invest more in segments with higher average spend or higher offer acceptance rates.
3. Develop loyalty programs or tiered benefits that cater to the specific spending patterns and preferences of different clusters.
4. Continuously monitor customer behavior and segment performance to refine segmentation and marketing strategies over time.
5. For segments with lower engagement or response rates, consider A/B testing different approaches to identify effective strategies.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="49"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:121}"
id="HUxNlzrfy9S1" data-outputId="f64741f6-3cd4-4753-8307-0720fbdee687">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython <span class="im">import</span> get_ipython</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if running in Colab or Jupyter</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> get_ipython() <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="kw">and</span> <span class="st">&#39;google.colab&#39;</span> <span class="kw">in</span> <span class="bu">str</span>(get_ipython()):</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the HTML content for the animation</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    thank_you_html <span class="op">=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;style&gt;</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="st">      @keyframes fadeInOut {</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="st">        0%, 100% { opacity: 0; }</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="st">        50% { opacity: 1; }</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="st">      .animated-text {</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="st">        font-weight: bold;</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="st">        font-size: 3em; /* Adjust the size as needed */</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="st">        animation: fadeInOut 3s ease-in-out infinite; /* 3s duration, ease-in-out timing, infinite loop */</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a><span class="st">      .smaller-text {</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="st">          font-size: 0.5em; /* Adjust the size as needed */</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a><span class="st">          font-weight: normal;</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/style&gt;</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div class=&quot;animated-text&quot;&gt;Thank you&lt;br&gt;&lt;span class=&quot;smaller-text&quot;&gt;Project by Rijwan Shaikh&lt;/span&gt;&lt;/div&gt;</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Display the HTML</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>    display(HTML(thank_you_html))</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Thank you&quot;</span>)</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Project by Rijwan Shaikh&quot;</span>)</span></code></pre></div>
<div class="output display_data">

    <style>
      @keyframes fadeInOut {
        0%, 100% { opacity: 0; }
        50% { opacity: 1; }
      }

      .animated-text {
        font-weight: bold;
        font-size: 3em; /* Adjust the size as needed */
        animation: fadeInOut 3s ease-in-out infinite; /* 3s duration, ease-in-out timing, infinite loop */
      }

      .smaller-text {
          font-size: 0.5em; /* Adjust the size as needed */
          font-weight: normal;
      }
    </style>
    <div class="animated-text">Thank you<br><span class="smaller-text">Project by Rijwan Shaikh</span></div>
    
</div>
</div>
<div class="cell code" id="-6IEUXFW0AHq">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
